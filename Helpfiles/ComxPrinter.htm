
<HTML>
<Title>Parallel Printer Support</Title>
<BODY>
<h1>Parallel Printer Support</h1>
<p>
To run the COMX emulator with the Parallel printer card select f&m.printer.1.2.bin or printer.bin in any available slot (CARD 1 if no expansion box is used), see example below (yellow ellipse): 
</p>
<p>
<IMG SRC="images/comx_parallel_printer.png" BORDER="0">
</p>
<p>
For details on configuring other printer types, see <a href="ComxSerialPrinter.htm">Serial Printer Support</a>, <a href="ComxThermal.htm">Thermal Printer Support</a> and <a href="ComxPlotter.htm">PL-80 Plotter Simulation</a>. 
</p>
<h2>Printing to File</h2>
<p>
To print to a file select 'File' in the selection box next to the printer output file name (orange ellipse). When a 'printer on' command is send with a CARD P3 (if an <a href="ComxExpansion.htm">expansion box</a> is configured) or a CALL (@C070) a printout file is created (as specified in the orange ellipse). If the indicated print file already exists a new file is created with the next sequence number. E.g. if the print file is 'printerout.txt', this file is used the first time, after a CARD P1 (printer off) and a CARD P3 (printer on) the file printerout.1.txt' will be created.
</p>
<h2>Printing to Screen and or Printer</h2>
<p>
To print to an output screen and/or to a real printer, first select 'STD' (orange ellipse):
</p>
<p>
<IMG SRC="images/comx_parallel_printer_screen.png" BORDER="0">
</p>
<p>
After this send a 'printer on' command from the COMX or open the printer output screen manually. A 'printer on' command from the COMX can be done with a CARD P3 (if an <a href="ComxExpansion.htm">expansion box</a> is configured) or a CALL (@C070). To open the output screen manually, press the F4 button or the printer icon (blue ellipse) before giving printer commands from the COMX.
</p>
<p>
<IMG SRC="images/comx_parallel_printer_window.png" BORDER="0">
</p>
<p>
When the printer output screen opens, the print, preview and setup buttons will be disabled. When the COMX is ready with the printout and a CARD P1 or CALL (@C050) is given these buttons will be enabled (yellow ellipse). After this it is possible to use the print button to send the printout to a real printer, use preview and/or change printer settings. 
</p>
<p>
To start a new printout close the printer output screen. After this a new printer window will be created when the COMX starts the first output to the printer.
</p>
<p>
The printer font can be changed with the second 'Font' choice buttons (blue ellipse). Default the teletype font is used which has a fixed width per line (like a matrix printer), all other fonts have a variable character width. The number of characters per line can be changed (40, 80, 96 or 120) with the first 'Font' choice button (orange ellipse). 
</p>
<p>
It is possible to disable the COMX status LEDs by clicking one of the LEDs, a red cross shows the LEDs are disabled (yellow ellipse). This will speed up printout especially when using higher CPU speeds.
</p>
<p>
<IMG SRC="images/comx_status_leds.png" BORDER="0">
</p>
<h2>Parallel Printer CALL and CARD Routines</h2>
<p>
The printer can be controlled from the COMX by using the CARD Pm commands as described below and in the <a href="ComxExpansion.htm">Expansion Box</a> chapter. If no expansion box is used the same commands can be activated by CALL statements:
</p>
<p>
<table>
<tbody>
<tr>
<td><B>CALL Syntax</B></td>
<td><B>CARD Syntax</B></td>
<td><B>Function</B></td>
</tr>
<tr>
<td>CALL (@C040, m)</td>
<td>CARD P0m</td>
<td>Selection routine (m = 1-11, for P1-P11)</td>
</tr>
<tr>
<td>CALL (@C050)</td>
<td>CARD P1</td>
<td>Switch off the printer</td>
</tr>
<tr>
<td>CALL (@C060)</td>
<td>CARD P2</td>
<td>Switch on the printer with control character suppressed </td>
</tr>
<tr>
<td>CALL (@C070)</td>
<td>CARD P3</td>
<td>Switch on the printer</td>
</tr>
<tr>
<td>CALL (@C080)</td>
<td>CARD P4</td>
<td>Switch on the printer and TV display mode with control character suppressed</td>
</tr>
<tr>
<td>CALL (@C090)</td>
<td>CARD P5</td>
<td>Switch on the printer and TV display mode </td>
</tr>
<tr>
<td>CALL (@C0A0)</td>
<td>CARD P6</td>
<td>Disable keyboard input to printer</td>
</tr>
<tr>
<td>CALL (@C030)</td>
<td>CARD P7</td>
<td>F&M Feature Select
<br>(CARD P7 is only available in F&M ROM version 1.1 or 1.2, in 1.0 use CALL (@C030))</td>
</tr>
<tr>
<td>CALL (@C0C0)</td>
<td>CARD P8</td>
<td>Memory dump</td>
</tr>
<tr>
<td>CALL (@C0D0, m)</td>
<td></td>
<td>Shape characters<br>
m = 1: Default<br>
m = 2: small shift<br>
m = 3: capitals shift<br>
(F&M rom only)</td>
</tr>
<tr>
<td></td>
<td>CARD P9</td>
<td>Shape small characters<br>(only available in F&M ROM)</td>
</tr>
<tr>
<td>CALL (@C0E0)</td>
<td>CARD P10</td>
<td>Self test</td>
</tr>
<tr>
<td>CALL (@C0F0)</td>
<td>CARD P11</td>
<td>Recall Basic after reset, will only work if Basic program started with '10 REM' before restart<br>
(only available in F&M ROM)</td>
</tr>
<tr>
<td>CALL (@C800)</td>
<td></td>
<td>TURBO PSAVE<br>
(F&M rom only)</td>
</tr>
<tr>
<td>CALL (@C810)</td>
<td></td>
<td>TURBO PLOAD<br>
(F&M rom only)</td>
</tr>
<tr>
<td>CALL (@C820)</td>
<td></td>
<td>TURBO DSAVE<br>
(F&M rom only)</td>
</tr>
<tr>
<td>CALL (@C830)</td>
<td></td>
<td>TURBO DLOAD<br>
(F&M rom only)</td>
</tr>
<tr>
<td>CALL (@C800)+</td>
<td></td>
<td>TURBO PSAVE+<br>
(F&M rom only)</td>
</tr>
<tr>
<td>CALL (@C810)+</td>
<td></td>
<td>TURBO PLOAD+<br>
(F&M rom only)</td>
</tr>
<tr>
<td>CALL (@C820)+</td>
<td></td>
<td>TURBO DSAVE+<br>
(F&M rom only)</td>
</tr>
<tr>
<td>CALL (@C830)+</td>
<td></td>
<td>TURBO DLOAD+<br>
(F&M rom only)</td>
</tr>
</table>
</p>
<p>
Note: if the expansion box is used the user should enable the standard printer card first before any assembly call is initiated. This can be done by the OUT 1 instruction or in BASIC by using any CARD Pm statement before the CALL statement.
</p>
</BODY>
</HTML>
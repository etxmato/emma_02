; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

[Setup]
AppName=Emma 02
AppVerName=Emma 02 - V1.48.6
AppVersion=1.48.6
AppPublisher=Marcel van Tongeren
DefaultDirName={pf}\Emma 02
DefaultGroupName=Emma 02
OutputDir=x86
OutputBaseFilename=emma_02_x86_windows
Compression=lzma
SolidCompression=true
SetupIconFile=..\images\app.ico
UninstallDisplayIcon={app}\images\app.ico
DisableDirPage=false
FlatComponentsList=false
InfoBeforeFile=..\copyright.rtf
WizardImageBackColor=clWhite
WizardImageStretch=true
WizardImageFile=emma 02 large.bmp
WizardSmallImageFile=emma 02.bmp
ShowLanguageDialog=no
AppPublisherURL=http://www.emma02.hobby-site.com/
AppSupportURL=http://www.comxclub.hobby-site.com/forum/forumdisplay.php?fid=4
AppUpdatesURL=http://www.emma02.hobby-site.com/index_change_log.html

[Languages]
Name: english; MessagesFile: compiler:Default.isl

[Tasks]
Name: desktopicon; Description: {cm:CreateDesktopIcon}; GroupDescription: {cm:AdditionalIcons}; Flags: unchecked

[Files]
Source: vcredist_x86.exe; DestDir: {tmp}; Flags: deleteafterinstall; Components: MAIN
Source: ..\Win32\Release\Emma 02.exe; DestDir: {app}; Components: MAIN; Tasks: ; Languages: 
Source: ..\emma_02.htb; DestDir: {app}; Components: MAIN
Source: ..\*.def; DestDir: {app}; Components: MAIN
Source: ..\*.syntax; DestDir: {app}; Components: MAIN
Source: ..\about_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\about_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\cassette_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\cassette_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\datadir_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\datadir_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\functionkey_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\functionkey_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\keymap_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\keymap_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\keymap_tmc_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\keymap_tmc_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\main_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\main_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\menuXml_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\menuXml_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\sb_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\sb_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\splash_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\splash_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\vt_11.xrc; DestDir: {app}; Components: MAIN
Source: ..\vt_12.xrc; DestDir: {app}; Components: MAIN
Source: ..\win8_11.ini; DestDir: {app}; Components: MAIN
Source: ..\win8_12.ini; DestDir: {app}; Components: MAIN
Source: ..\win10_11.ini; DestDir: {app}; Components: MAIN
Source: ..\win10_12.ini; DestDir: {app}; Components: MAIN
Source: ..\win2000_11.ini; DestDir: {app}; Components: MAIN
Source: ..\win2000_12.ini; DestDir: {app}; Components: MAIN
Source: ..\winxp_11.ini; DestDir: {app}; Components: MAIN
Source: ..\winxp_12.ini; DestDir: {app}; Components: MAIN
Source: ..\..\SDL2-2.0.5\lib\x86\SDL2.dll; DestDir: {app}; Components: MAIN
Source: ..\..\libserialport\Win32\lib\libserialport.dll; DestDir: {app}; Components: MAIN
Source: ..\OpenSSL - LICENSE; DestDir: {app}; Components: MAIN
Source: ..\Quest_license.txt; DestDir: {app}; Components: MAIN
Source: ..\Quest_CC_Lic.jpg; DestDir: {app}; Components: MAIN
Source: ..\README-SDL.txt; DestDir: {app}; Components: MAIN
Source: ..\agpl-3.0.txt; DestDir: {app}; Components: MAIN
Source: ..\LGPL.txt; DestDir: {app}; Components: MAIN
Source: ..\COPYING - curl; DestDir: {app}; Components: MAIN
Source: ..\data\data dir for portable mode.txt; DestDir: {app}\data; Components: MAIN
Source: ..\data\keydefinition.txt; DestDir: {app}\data; Components: MAIN
Source: ..\data\keydefinition_studio.txt; DestDir: {app}\data; Components: MAIN
Source: ..\data\multi-cart.txt; DestDir: {app}\data; Components: MAIN
Source: ..\data\us.ini; DestDir: {app}\data; Components: MAIN
Source: ..\data\swedish.ini; DestDir: {app}\data; Components: MAIN
Source: ..\data\german.ini; DestDir: {app}\data; Components: MAIN
Source: ..\data\dutch.ini; DestDir: {app}\data; Components: MAIN
Source: ..\data\french.ini; DestDir: {app}\data; Components: MAIN
Source: ..\data\CDP18S020\*.*; DestDir: {app}\data\CDP18S020; Components: MAIN
Source: ..\data\Chip-8\Chip-8 Demos\*.*; DestDir: {app}\data\Chip-8\Chip-8 Demos; Components: MAIN
Source: ..\data\Chip-8\Chip-8 ETI660 Games\*.*; DestDir: {app}\data\Chip-8\Chip-8 ETI660 Games; Components: MAIN
Source: ..\data\Chip-8\Chip-8 ETI660 Hybrids\*.*; DestDir: {app}\data\Chip-8\Chip-8 ETI660 Hybrids; Components: MAIN
Source: ..\data\Chip-8\Chip-8 ETI660 Programs\*.*; DestDir: {app}\data\Chip-8\Chip-8 ETI660 Programs; Components: MAIN
Source: ..\data\Chip-8\Chip-8 Games\*.*; DestDir: {app}\data\Chip-8\Chip-8 Games; Components: MAIN
Source: ..\data\Chip-8\Chip-8 Hires\*.*; DestDir: {app}\data\Chip-8\Chip-8 Hires; Components: MAIN
Source: ..\data\Chip-8\Chip-8 Hybrids\*.*; DestDir: {app}\data\Chip-8\Chip-8 Hybrids; Components: MAIN
Source: ..\data\Chip-8\Chip-8 Programs\*.*; DestDir: {app}\data\Chip-8\Chip-8 Programs; Components: MAIN
Source: ..\data\Chip-8\Chip-8X\*.*; DestDir: {app}\data\Chip-8\Chip-8X; Components: MAIN
Source: ..\data\Chip-8\Chip-10\*.*; DestDir: {app}\data\Chip-8\Chip-10; Components: MAIN
Source: ..\data\Chip-8\Super-Chip Games\*.*; DestDir: {app}\data\Chip-8\Super-Chip Games; Components: MAIN
Source: ..\data\Cidelsa\*.*; DestDir: {app}\data\Cidelsa; Components: MAIN
Source: ..\data\CoinArcade\*.*; DestDir: {app}\data\CoinArcade; Components: MAIN
Source: ..\data\Comx\*.*; DestDir: {app}\data\Comx; Components: MAIN
Source: ..\data\Comx\Demo\*.*; DestDir: {app}\data\Comx\Demo; Components: MAIN
Source: ..\data\Comx\Disks\*.*; DestDir: {app}\data\Comx\Disks; Components: MAIN
Source: ..\data\Comx\Educatief\*.*; DestDir: {app}\data\Comx\Educatief; Components: MAIN
Source: ..\data\Comx\Educational\*.*; DestDir: {app}\data\Comx\Educational; Components: MAIN
Source: ..\data\Comx\F&M Basic\*.*; DestDir: {app}\data\Comx\F&M Basic; Components: MAIN
Source: ..\data\Comx\F&M EPROM Switchboard\*.*; DestDir: {app}\data\Comx\F&M EPROM Switchboard; Components: MAIN
Source: ..\data\Comx\Games\*.*; DestDir: {app}\data\Comx\Games; Components: MAIN
Source: ..\data\Comx\Hulpmiddelen - Utilities\*.*; DestDir: {app}\data\Comx\Hulpmiddelen - Utilities; Components: MAIN
Source: ..\data\Comx\Plotter\*.*; DestDir: {app}\data\Comx\Plotter; Components: MAIN
Source: ..\data\Comx\Programmas\*.*; DestDir: {app}\data\Comx\Programmas; Components: MAIN
Source: ..\data\Comx\Programs\*.*; DestDir: {app}\data\Comx\Programs; Components: MAIN
Source: ..\data\Comx\Spellen\*.*; DestDir: {app}\data\Comx\Spellen; Components: MAIN
Source: ..\data\Comx\Talen - Languages\*.*; DestDir: {app}\data\Comx\Talen - Languages; Components: MAIN
Source: ..\data\Comx\Usb FW Development\sb*.bin; DestDir: {app}\data\Comx\Usb FW; Components: MAIN
Source: ..\data\Comx\Usb FW Development\*.debug; DestDir: {app}\data\Comx\Usb FW; Components: MAIN
Source: ..\data\Comx\Usb FW\sb.config; DestDir: {app}\data\Comx\Usb FW; Components: MAIN
Source: ..\data\Conic\*.*; DestDir: {app}\data\Conic; Components: MAIN
Source: ..\data\CosmacGameSystem\*.*; DestDir: {app}\data\CosmacGameSystem; Components: MAIN
Source: ..\data\Cosmicos\*.*; DestDir: {app}\data\Cosmicos; Components: MAIN
Source: ..\data\Cybervision\*.*; DestDir: {app}\data\Cybervision; Components: MAIN
Source: ..\data\Elf\*.*; DestDir: {app}\data\Elf; Components: MAIN
Source: ..\data\Elf\Biosio\*.*; DestDir: {app}\data\Elf\Biosio; Components: MAIN
Source: ..\data\Elf\biosioPS2\*.*; DestDir: {app}\data\Elf\BiosioPS2; Components: MAIN
Source: ..\data\Elf\elf-emulation.com\*.*; DestDir: {app}\data\Elf\elf-emulation.com; Components: MAIN
Source: ..\data\Elf\elf-emulation.com\EdtAsm\*.*; DestDir: {app}\data\Elf\elf-emulation.com\EdtAsm; Components: MAIN
Source: ..\data\Elf\elf-emulation.com\RcForth Rom Version\*.*; DestDir: {app}\data\Elf\elf-emulation.com\RcForth Rom Version; Components: MAIN
Source: ..\data\Elf\elf-emulation.com\RcForth v1.0\*.*; DestDir: {app}\data\Elf\elf-emulation.com\RcForth v1.0; Components: MAIN
Source: ..\data\Elf\elf-emulation.com\RcLisp Rom Version\*.*; DestDir: {app}\data\Elf\elf-emulation.com\RcLisp Rom Version; Components: MAIN
Source: ..\data\Elf\elf-emulation.com\Tiny Basic Compiler Rom Version\*.*; DestDir: {app}\data\Elf\elf-emulation.com\Tiny Basic Compiler Rom Version; Components: MAIN
Source: ..\data\Elf\Fig Forth 1802\*.*; DestDir: {app}\data\Elf\Fig Forth 1802; Components: MAIN
Source: ..\data\Elf\Games\*.*; DestDir: {app}\data\Elf\Games; Components: MAIN
Source: ..\data\Elf\Music\*.*; DestDir: {app}\data\Elf\Music; Components: MAIN
Source: ..\data\Elf\Netronics Tiny Basic\*.*; DestDir: {app}\data\Elf\Netronics Tiny Basic; Components: MAIN
Source: ..\data\Elf\Pico Elf\*.*; DestDir: {app}\data\Elf\Pico Elf; Components: MAIN
Source: ..\data\Elf\Pico Elf\TMS9118\*.*; DestDir: {app}\data\Elf\Pico Elf\TMS9118; Components: MAIN
Source: ..\data\Elf\QuestData\*.*; DestDir: {app}\data\Elf\QuestData; Components: MAIN
Source: ..\data\Elf\SuperBasic\*.*; DestDir: {app}\data\Elf\SuperBasic; Components: MAIN
Source: ..\data\Elf\TinyBasic\*.*; DestDir: {app}\data\Elf\TinyBasic; Components: MAIN
Source: ..\data\Elf\TinyosTS\*.*; DestDir: {app}\data\Elf\TinyosTS; Components: MAIN
Source: ..\data\Elf\VDU\*.*; DestDir: {app}\data\Elf\VDU; Components: MAIN
Source: ..\data\Elf2K\*.*; DestDir: {app}\data\Elf2K; Components: MAIN
Source: ..\data\Elf2K\1802 Disassembler\*.*; DestDir: {app}\data\Elf2K\1802 Disassembler\; Components: MAIN
Source: ..\data\Elf2K\Clock\*.*; DestDir: {app}\data\Elf2K\Clock\; Components: MAIN
Source: ..\data\Elf2K\Tinyos2k\*.*; DestDir: {app}\data\Elf2K\Tinyos2k; Components: MAIN
Source: ..\data\Eti\*.*; DestDir: {app}\data\Eti; Components: MAIN
Source: ..\data\FRED1\*.*; DestDir: {app}\data\FRED1; Components: MAIN
Source: ..\data\FRED1_5\*.*; DestDir: {app}\data\FRED1_5; Components: MAIN
Source: ..\data\HEC1802\*.*; DestDir: {app}\data\HEC1802; Components: MAIN
Source: ..\data\HUG1802\*.*; DestDir: {app}\data\HUG1802; Components: MAIN
Source: ..\data\Macbug\*.*; DestDir: {app}\data\Macbug; Components: MAIN
Source: ..\data\MCDS\*.*; DestDir: {app}\data\MCDS; Components: MAIN
Source: ..\data\Membership\*.*; DestDir: {app}\data\Membership; Components: MAIN
Source: ..\data\Microboard\*.*; DestDir: {app}\data\Microboard; Components: MAIN
Source: ..\data\Microboard\BASIC\*.*; DestDir: {app}\data\Microboard\BASIC; Components: MAIN
Source: ..\data\Microboard\MICRODOS\*.*; DestDir: {app}\data\Microboard\MICRODOS; Components: MAIN
Source: ..\data\Microboard\PLM\*.*; DestDir: {app}\data\Microboard\PLM; Components: MAIN
Source: ..\data\Microboard\RP\*.*; DestDir: {app}\data\Microboard\RP; Components: MAIN
Source: ..\data\Microboard\Software\*.*; DestDir: {app}\data\Microboard\Software; Components: MAIN
Source: ..\data\Microtutor\*.*; DestDir: {app}\data\Microtutor; Components: MAIN
Source: ..\data\MicrotutorII\*.*; DestDir: {app}\data\MicrotutorII; Components: MAIN
Source: ..\data\MS2000\*.*; DestDir: {app}\data\MS2000; Components: MAIN
Source: ..\data\MS2000\BASIC\*.*; DestDir: {app}\data\MS2000\BASIC; Components: MAIN
Source: ..\data\MS2000\MICRODOS\*.*; DestDir: {app}\data\MS2000\MICRODOS; Components: MAIN
Source: ..\data\MS2000\PLM\*.*; DestDir: {app}\data\MS2000\PLM; Components: MAIN
Source: ..\data\MS2000\RP\*.*; DestDir: {app}\data\MS2000\RP; Components: MAIN
Source: ..\data\MS2000\Software\*.*; DestDir: {app}\data\MS2000\Software; Components: MAIN
Source: ..\data\Nano\*.*; DestDir: {app}\data\Nano; Components: MAIN
Source: ..\data\Pecom\*.*; DestDir: {app}\data\Pecom; Components: MAIN
Source: ..\data\Pico\*.*; DestDir: {app}\data\Pico; Components: MAIN
Source: ..\data\SBC1802\*.*; DestDir: {app}\data\SBC1802; Components: MAIN
Source: ..\data\St2\Conic_StudioIII-Cartridges\*.*; DestDir: {app}\data\St2\Conic_StudioIII-Cartridges; Components: MAIN
Source: ..\data\St2\Conic_StudioIII-Homebrew\*.*; DestDir: {app}\data\St2\Conic_StudioIII-Homebrew; Components: MAIN
Source: ..\data\St2\Conic_StudioIII-Sarnoff-Collection\*.*; DestDir: {app}\data\St2\Conic_StudioIII-Sarnoff-Collection; Components: MAIN
Source: ..\data\St2\StudioII-Cartridges\*.*; DestDir: {app}\data\St2\StudioII-Cartridges; Components: MAIN
Source: ..\data\St2\StudioII-Homebrew\*.*; DestDir: {app}\data\St2\StudioII-Homebrew; Components: MAIN
Source: ..\data\St2\StudioII-Sarnoff-Collection\*.*; DestDir: {app}\data\St2\StudioII-Sarnoff-Collection; Components: MAIN
Source: ..\data\St2\Visicom-Cartridges\*.*; DestDir: {app}\data\St2\Visicom-Cartridges; Components: MAIN
Source: ..\data\StudioII\*.*; DestDir: {app}\data\StudioII; Components: MAIN
Source: ..\data\StudioIII\*.*; DestDir: {app}\data\StudioIII; Components: MAIN
Source: ..\data\StudioIV\*.*; DestDir: {app}\data\StudioIV; Components: MAIN
Source: ..\data\TMC600\*.*; DestDir: {app}\data\TMC600; Components: MAIN
Source: ..\data\TMC1800\*.*; DestDir: {app}\data\TMC1800; Components: MAIN
Source: ..\data\TMC2000\*.*; DestDir: {app}\data\TMC2000; Components: MAIN
Source: ..\data\UC1800\*.*; DestDir: {app}\data\UC1800; Components: MAIN
Source: ..\data\Velf\*.*; DestDir: {app}\data\Velf; Components: MAIN
Source: ..\data\Victory\*.*; DestDir: {app}\data\Victory; Components: MAIN
Source: ..\data\Vip\*.*; DestDir: {app}\data\Vip; Components: MAIN
Source: ..\data\Vip2K\*.*; DestDir: {app}\data\Vip2K; Components: MAIN
Source: ..\data\VipII\*.*; DestDir: {app}\data\VipII; Components: MAIN
Source: ..\data\VIS1802\*.*; DestDir: {app}\data\VIS1802; Components: MAIN
Source: ..\data\VT1802\*.*; DestDir: {app}\data\VT1802; Components: MAIN
Source: ..\data\Visicom\*.*; DestDir: {app}\data\Visicom; Components: MAIN
Source: ..\data\Xml\*.*; DestDir: {app}\data\Xml; Components: MAIN
Source: ..\data\Xml\CDP18S020\*.*; DestDir: {app}\data\Xml\CDP18S020; Components: MAIN
Source: ..\data\Xml\Cidelsa\*.*; DestDir: {app}\data\Xml\Cidelsa; Components: MAIN
Source: ..\data\Xml\CoinArcade\*.*; DestDir: {app}\data\Xml\CoinArcade; Components: MAIN
Source: ..\data\Xml\Comix\*.*; DestDir: {app}\data\Xml\Comix; Components: MAIN
Source: ..\data\Xml\Comx\*.*; DestDir: {app}\data\Xml\Comx; Components: MAIN
Source: ..\data\Xml\Conic\*.*; DestDir: {app}\data\Xml\Conic; Components: MAIN
Source: ..\data\Xml\CosmacElf\*.*; DestDir: {app}\data\Xml\CosmacElf; Components: MAIN
Source: ..\data\Xml\CosmacGameSystem\*.*; DestDir: {app}\data\Xml\CosmacGameSystem; Components: MAIN
Source: ..\data\Xml\Cosmicos\*.*; DestDir: {app}\data\Xml\Cosmicos; Components: MAIN
Source: ..\data\Xml\Cybervision\*.*; DestDir: {app}\data\Xml\Cybervision; Components: MAIN
Source: ..\data\Xml\Elf\*.*; DestDir: {app}\data\Xml\Elf; Components: MAIN
Source: ..\data\Xml\Elf2K\*.*; DestDir: {app}\data\Xml\Elf2K; Components: MAIN
Source: ..\data\Xml\Eti\*.*; DestDir: {app}\data\Xml\Eti; Components: MAIN
Source: ..\data\Xml\FRED1\*.*; DestDir: {app}\data\Xml\FRED1; Components: MAIN
Source: ..\data\Xml\FRED1_5\*.*; DestDir: {app}\data\Xml\FRED1_5; Components: MAIN
Source: ..\data\Xml\HEC1802\*.*; DestDir: {app}\data\Xml\HEC1802; Components: MAIN
Source: ..\data\Xml\HUG1802\*.*; DestDir: {app}\data\Xml\HUG1802; Components: MAIN
Source: ..\data\Xml\JVIP\*.*; DestDir: {app}\data\Xml\JVIP; Components: MAIN
Source: ..\data\Xml\Macbug\*.*; DestDir: {app}\data\Xml\Macbug; Components: MAIN
Source: ..\data\Xml\MCDS\*.*; DestDir: {app}\data\Xml\MCDS; Components: MAIN
Source: ..\data\Xml\Membership\*.*; DestDir: {app}\data\Xml\Membership; Components: MAIN
Source: ..\data\Xml\Microboard\*.*; DestDir: {app}\data\Xml\Microboard; Components: MAIN
Source: ..\data\Xml\Microtutor\*.*; DestDir: {app}\data\Xml\Microtutor; Components: MAIN
Source: ..\data\Xml\MicrotutorII\*.*; DestDir: {app}\data\Xml\MicrotutorII; Components: MAIN
Source: ..\data\Xml\MS2000\*.*; DestDir: {app}\data\Xml\MS2000; Components: MAIN
Source: ..\data\Xml\Nano\*.*; DestDir: {app}\data\Xml\Nano; Components: MAIN
Source: ..\data\Xml\NetronicsElfII\*.*; DestDir: {app}\data\Xml\NetronicsElfII; Components: MAIN
Source: ..\data\Xml\Pecom32\*.*; DestDir: {app}\data\Xml\Pecom32; Components: MAIN
Source: ..\data\Xml\Pecom64\*.*; DestDir: {app}\data\Xml\Pecom64; Components: MAIN
Source: ..\data\Xml\PicoElfV2\*.*; DestDir: {app}\data\Xml\PicoElfV2; Components: MAIN
Source: ..\data\Xml\QuestSuperElf\*.*; DestDir: {app}\data\Xml\QuestSuperElf; Components: MAIN
Source: ..\data\Xml\Studio2020\*.*; DestDir: {app}\data\Xml\Studio2020; Components: MAIN
Source: ..\data\Xml\StudioII\*.*; DestDir: {app}\data\Xml\StudioII; Components: MAIN
Source: ..\data\Xml\StudioIII\*.*; DestDir: {app}\data\Xml\StudioIII; Components: MAIN
Source: ..\data\Xml\StudioIV\*.*; DestDir: {app}\data\Xml\StudioIV; Components: MAIN
Source: ..\data\Xml\TMC600\*.*; DestDir: {app}\data\Xml\TMC600; Components: MAIN
Source: ..\data\Xml\TMC1800\*.*; DestDir: {app}\data\Xml\TMC1800; Components: MAIN
Source: ..\data\Xml\TMC2000\*.*; DestDir: {app}\data\Xml\TMC2000; Components: MAIN
Source: ..\data\Xml\UC1800\*.*; DestDir: {app}\data\Xml\UC1800; Components: MAIN
Source: ..\data\Xml\Velf\*.*; DestDir: {app}\data\Xml\Velf; Components: MAIN
Source: ..\data\Xml\Vip\*.*; DestDir: {app}\data\Xml\Vip; Components: MAIN
Source: ..\data\Xml\Vip2K\*.*; DestDir: {app}\data\Xml\Vip2K; Components: MAIN
Source: ..\data\Xml\VipII\*.*; DestDir: {app}\data\Xml\VipII; Components: MAIN
Source: ..\data\Xml\VIS1802\*.*; DestDir: {app}\data\Xml\VIS1802; Components: MAIN
Source: ..\data\Xml\VT1802\*.*; DestDir: {app}\data\Xml\VT1802; Components: MAIN
Source: ..\data\Xml\Visicom\*.*; DestDir: {app}\data\Xml\Visicom; Components: MAIN
Source: ..\images\*.*; DestDir: {app}\images; Components: MAIN
Source: ..\src\*.*; DestDir: {app}\src; Components: SOURCEFILES
Source: ..\Emma 02 vc9.sln; DestDir: {app}; Components: SOURCEFILES
Source: ..\Emma 02 vc9.vcproj; DestDir: {app}; Components: SOURCEFILES
Source: ..\Emma 02.rc; DestDir: {app}; Components: SOURCEFILES

[Icons]
Name: {group}\Emma 02; Filename: {app}\Emma 02.exe; WorkingDir: {app}; Components: MAIN
Name: {group}\{cm:UninstallProgram,Emma 02}; Filename: {uninstallexe}; Components: MAIN
Name: {commondesktop}\Emma 02; Filename: {app}\Emma 02.exe; WorkingDir: {app}; Tasks: desktopicon


[Run]
Filename: {tmp}\vcredist_x86.exe; Parameters: /quiet; Components: MAIN
Filename: {app}\Emma 02.exe; Description: {cm:LaunchProgram,Emma 02}; WorkingDir: {app}; Flags: nowait postinstall skipifsilent; OnlyBelowVersion: 0,6

[Components]
Name: MAIN; Description: Main Files; Types: full compact custom minimum; Flags: disablenouninstallwarning fixed
Name: SOURCEFILES; Description: Install Source Files; Types: full; Flags: disablenouninstallwarning

[Types]
Name: full; Description: Full installation
Name: compact; Description: Compact installation
Name: minimum; Description: Minimum installation
Name: custom; Description: Custom installation; Flags: iscustom

[Code]
procedure CurStepChanged(CurStep: TSetupStep);

  var
    ResultCode: Integer;
    Uninstall: String;
    StrVersion: String;
    IntVersion: Integer;
    UserDir: String;
    OldUserDir: String;
    fredDirOld: String;
    fredDirNew: String;
    cdpDir: String;
    MajorVersion: Cardinal;
    MinorVersion: Cardinal;
  begin
    if (CurStep = ssInstall) then begin

      fredDirOld :=  ExpandConstant('{app}') + '\data\FRED2';
      fredDirNew :=  ExpandConstant('{app}') + '\data\FRED1_5';
      if DirExists(fredDirOld) then
      begin
        RenameFile(fredDirOld, fredDirNew);
      end;

      fredDirOld :=  ExpandConstant('{app}') + '\Configurations\FRED2';
      fredDirNew :=  ExpandConstant('{app}') + '\Configurations\FRED1_5';
      if DirExists(fredDirOld) then
      begin
        RenameFile(fredDirOld, fredDirNew);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\CDP18S600';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\Configurations\CDP18S600';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\CDP18S601';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\Configurations\CDP18S601';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\CDP18S603A';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\Configurations\CDP18S603A';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\Xml\Cosmac Elf';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\Xml\Microtutor II';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\Xml\Netronics Elf II';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\Xml\Pecom';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\Xml\Pico Elf V2';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\Xml\Quest Super Elf';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      cdpDir := ExpandConstant('{app}') + '\data\Xml\TMC-600';
      if DirExists(cdpDir) then
      begin
        DelTree(cdpDir, True, True, True);
      end;

      if RegQueryStringValue(HKLM, 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\1802 Emulator_is1', 'UninstallString', Uninstall) then begin
        StrVersion := '0';
        RegQueryStringValue(HKLM, 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\1802 Emulator_is1', 'DisplayVersion', StrVersion);
        IntVersion := StrToInt (StrVersion);
        if (IntVersion < 4) then begin
          if MsgBox('An older version of the 1802 Emulator has been detected and needs to be uninstalled, do you want to continue?', mbConfirmation, MB_YESNO) = IDNO then
          begin
             Abort;
          end;
          Exec(RemoveQuotes(Uninstall), ' /SILENT', '', SW_SHOWNORMAL, ewWaitUntilTerminated, ResultCode);
          UserDir := ExpandConstant('{userappdata}') + '\Emma 02';
          OldUserDir := ExpandConstant('{userappdata}') + '\1802_Emulator';
          if DirExists(OldUserDir) = True then
          begin
            if RenameFile(OldUserDir, UserDir) = False then
            begin
              MsgBox('Not all user data could be moved, please check 1802_Emulator user directory and manually move needed files to the Emma 02 folder.', mbInformation, MB_OK);
            end;
          end;
        end;
      end;

      if RegQueryStringValue(HKLM, 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Emma 02_is1', 'UninstallString', Uninstall) then begin
        MajorVersion := 0;
        MinorVersion := 0;
        RegQueryDWordValue(HKLM, 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Emma 02_is1', 'MajorVersion', MajorVersion);
        RegQueryDWordValue(HKLM, 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Emma 02_is1', 'MinorVersion', MinorVersion);
        if (MajorVersion < 2) then begin
          if (MinorVersion < 18) then begin
            if MsgBox('An older version of Emma 02 has been detected and needs to be uninstalled, do you want to continue?', mbConfirmation, MB_YESNO) = IDNO then
            begin
              Abort;
            end;
            Exec(RemoveQuotes(Uninstall), ' /SILENT', '', SW_SHOWNORMAL, ewWaitUntilTerminated, ResultCode);
          end;
        end;
      end;

	    if IsWin64 then
  	  begin
	      if RegQueryStringValue(HKLM64, 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Emma 02_is1', 'UninstallString', Uninstall) then
        begin
          if MsgBox('A 64 bit version of Emma 02 has been detected and needs to be uninstalled, do you want to continue?', mbConfirmation, MB_YESNO) = IDNO then
          begin
            Abort;
          end;
          Exec(RemoveQuotes(Uninstall), ' /SILENT', '', SW_SHOWNORMAL, ewWaitUntilTerminated, ResultCode);
        end;
      end;

    end;
  end;
end.

[Registry]
Root: HKCU; Subkey: Software\1802_emulator; Flags: deletekey; Components: ; Tasks: ; Languages: 
Root: HKCU; Subkey: Software\Marcel van Tongeren\Emma 02; Flags: deletekey; Components: ; Tasks: ; Languages: 

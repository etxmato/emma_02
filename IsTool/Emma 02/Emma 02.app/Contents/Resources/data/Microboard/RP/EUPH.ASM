.. 1000 PRINT "THE KINGDOM OF EUPHORIA"..
  ORG 00000H
ES EQU 13
AC EQU 10
ZZ EQU 4
XX EQU 8
S EQU 11
L EQU 9
..
RESET  NOP;BR INIT;LBR SAVER
GETCH  LBR CHIN
PUTCH  LBR CHOUT
INIT  GHI 0;PHI 3;PHI 4;PHI 5
  LDI CALL;PLO 4;LDI RETN;PLO 5
  LDI MAIN;PLO 3;SEP 3;DC A.0(01BH),02328H
  SEP 3
CALL  PLO RE;GHI 6;SEX 2;STXD;GLO 6;STXD
  GLO 3;PLO 6;GHI 3;PHI 6
  LDA 6;PHI 3;LDA 6;PLO 3;GLO RE;BR CALL-1
  SEP 3
RETN  PLO RE;SEX 2;GHI 6;PHI 3;GLO 6;PLO 3;INC 2
  LDA 2;PLO 6;LDN 2;PHI 6;GLO RE;BR RETN-1
SAVER  PLO AC;SEX 2;GLO S;STXD;GHI S;STXD
  GLO L;STXD;GHI L;STXD;GLO AC;ADI 0
  CALL RUN
  PLO AC;INC 2;LDA 2;PHI L;LDA 2;PLO L
  LDA 2;PHI S;LDN 2;PLO S;GLO AC;EXIT
MAIN  LDA 0;PHI ES;LDA 0;PHI 2;LDA 0;PLO 2
  LDI VARS;PLO ES;SMI 0
RUN  LDI STORE;PLO S;LDI A.1(STORE);PHI S
  LDI 0;PHI AC;PLO AC;LSNF;SEP S;DC A.0(TTYCC)
  LDI LINE;PHI AC;LSNF;SEP S;DC A.0(INPTR)
  LDI LOAD;PLO L;LDI A.1(LOAD);PHI L
..
TTYCC EQU 01B58H
INPTR EQU 01B59H
CDENT EQU 1EH
UCALL EQU 0B453H
LINE EQU 01B5AH
VARS EQU 01BAAH
..
L1000
  CALL STRNG
  DC 'THE KINGDOM OF EUPHORIA'
  DC 9FH
  CALL CRLF
..
.. 1010 PRINT..
L1010
  CALL CRLF
..
.. 1020 GOSUB 3510..
L1020
  CALL L3510
..
.. 1100 REM PRINT STATE OF THE KINGDOM..
L1100
..
.. 1110 PRINT..
L1110
  CALL CRLF
..
.. 1120 PRINT "YEAR ";Y/7..
L1120
  CALL STRNG
  DC 'YEAR '
  DC 9FH
  SEP L;DC A.0(VY)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 007H;  PLO AC
  CALL DIV
  CALL PRN
  CALL CRLF
..
.. 1130 PRINT "POPULATION: ";P..
L1130
  CALL STRNG
  DC 'POPULATION: '
  DC 9FH
  SEP L;DC A.0(VP)
  CALL PRN
  CALL CRLF
..
.. 1140 IF B>0 THEN PRINT B;" BIRTHS"..
L1140
  SEP L;DC A.0(VB)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF1
  CALL PRN
  CALL STRNG
  DC ' BIRTHS'
  DC 9FH
  CALL CRLF
IF1
..
.. 1150 IF D>0 THEN PRINT D;" DEATHS BY NATURAL CAUSES"..
L1150
  SEP L;DC A.0(VD)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF2
  CALL PRN
  CALL STRNG
  DC ' DEATHS BY NATURAL CAUSES'
  DC 9FH
  CALL CRLF
IF2
..
.. 1160 IF S>0 THEN PRINT S;" DEATHS BY STARVATION"..
L1160
  SEP L;DC A.0(VS)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF3
  CALL PRN
  CALL STRNG
  DC ' DEATHS BY STARVATION'
  DC 9FH
  CALL CRLF
IF3
..
.. 1170 IF K>0 THEN PRINT K;" WAR CASUALTIES"..
L1170
  SEP L;DC A.0(VK)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF4
  CALL PRN
  CALL STRNG
  DC ' WAR CASUALTIES'
  DC 9FH
  CALL CRLF
IF4
..
.. 1180 IF V>0 THEN PRINT V;" VICTIMS OF DISEASE"..
L1180
  SEP L;DC A.0(VV)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF5
  CALL PRN
  CALL STRNG
  DC ' VICTIMS OF DISEASE'
  DC 9FH
  CALL CRLF
IF5
..
.. 1190 IF M>0 THEN PRINT M;" VICTIMS OF LOOTING"..
L1190
  SEP L;DC A.0(VM)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF6
  CALL PRN
  CALL STRNG
  DC ' VICTIMS OF LOOTING'
  DC 9FH
  CALL CRLF
IF6
..
.. 1210 LET D=D+S+K+V+M..
L1210
  SEP L;DC A.0(VD)
  CALL PUSH
  SEP L;DC A.0(VS)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VK)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VV)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VM)
  CALL ADD
  SEP S;DC A.0(VD)
..
.. 1220 LET P=P+B-D..
L1220
  SEP L;DC A.0(VP)
  CALL PUSH
  SEP L;DC A.0(VB)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VD)
  CALL SUB
  SEP S;DC A.0(VP)
..
.. 1230 IF B+D>0 THEN PRINT "TOTAL: ";P..
L1230
  SEP L;DC A.0(VB)
  CALL PUSH
  SEP L;DC A.0(VD)
  CALL ADD
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF7
  CALL STRNG
  DC 'TOTAL: '
  DC 9FH
  SEP L;DC A.0(VP)
  CALL PRN
  CALL CRLF
IF7
..
.. 1250 PRINT "LAND (ACRES): ";A..
L1250
  CALL STRNG
  DC 'LAND (ACRES): '
  DC 9FH
  SEP L;DC A.0(VA)
  CALL PRN
  CALL CRLF
..
.. 1260 IF T=0 THEN IF U=0 THEN GOTO 1350..
L1260
  SEP L;DC A.0(VT)
  GHI AC;LSNZ;GLO AC;  GLO AC;  LBNZ IF8
  SEP L;DC A.0(VU)
  GHI AC;LSNZ;GLO AC;  GLO AC;  LBNZ IF8
  LBR L1350
IF8
..
.. 1270 IF T>0 THEN PRINT T;" ACRES BOUGHT"..
L1270
  SEP L;DC A.0(VT)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF9
  CALL PRN
  CALL STRNG
  DC ' ACRES BOUGHT'
  DC 9FH
  CALL CRLF
IF9
..
.. 1280 IF T<0 THEN PRINT -T;" ACRES SOLD"..
L1280
  SEP L;DC A.0(VT)
  GHI AC;SHL;  LBNF IF10
  CALL NEG
  CALL PRN
  CALL STRNG
  DC ' ACRES SOLD'
  DC 9FH
  CALL CRLF
IF10
..
.. 1290 IF U<>0 THEN PRINT "FRUITS OF WAR: ";U;" ACRES"..
L1290
  SEP L;DC A.0(VU)
  GHI AC;LSNZ;GLO AC;  GLO AC;  LBZ IF11
  CALL STRNG
  DC 'FRUITS OF WAR: '
  DC 9FH
  SEP L;DC A.0(VU)
  CALL PRN
  CALL STRNG
  DC ' ACRES'
  DC 9FH
  CALL CRLF
IF11
..
.. 1310 LET A=A+T+U..
L1310
  SEP L;DC A.0(VA)
  CALL PUSH
  SEP L;DC A.0(VT)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VU)
  CALL ADD
  SEP S;DC A.0(VA)
..
.. 1320 LET T=0..
L1320
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VT)
..
.. 1330 LET U=0..
L1330
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VU)
..
.. 1340 PRINT "TOTAL: ";A..
L1340
  CALL STRNG
  DC 'TOTAL: '
  DC 9FH
  SEP L;DC A.0(VA)
  CALL PRN
  CALL CRLF
..
.. 1350 PRINT "GRAIN (BUSHELS): ";G..
L1350
  CALL STRNG
  DC 'GRAIN (BUSHELS): '
  DC 9FH
  SEP L;DC A.0(VG)
  CALL PRN
  CALL CRLF
..
.. 1360 IF C<0 THEN GOTO 1530..
L1360
  SEP L;DC A.0(VC)
  GHI AC;SHL;  LBNF IF12
  LBR L1530
IF12
..
.. 1370 IF C=0 THEN GOTO 1430..
L1370
  SEP L;DC A.0(VC)
  GHI AC;LSNZ;GLO AC;  GLO AC;  LBNZ IF13
  LBR L1430
IF13
..
.. 1380 LET R=X..
L1380
  SEP L;DC A.0(VX)
  SEP S;DC A.0(VR)
..
.. 1390 PRINT "CROP YIELD ";C;" AT ";..
L1390
  CALL STRNG
  DC 'CROP YIELD '
  DC 9FH
  SEP L;DC A.0(VC)
  CALL PRN
  CALL STRNG
  DC ' AT '
  DC 9FH
..
.. 1410 GOSUB 3220..
L1410
  CALL L3220
..
.. 1420 PRINT..
L1420
  CALL CRLF
..
.. 1430 IF F>0 THEN PRINT F;" BUSHELS USED FOR FOOD"..
L1430
  SEP L;DC A.0(VF)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF14
  CALL PRN
  CALL STRNG
  DC ' BUSHELS USED FOR FOOD'
  DC 9FH
  CALL CRLF
IF14
..
.. 1440 IF Q>0 THEN PRINT Q;" BUSHELS PLANTED"..
L1440
  SEP L;DC A.0(VQ)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF15
  CALL PRN
  CALL STRNG
  DC ' BUSHELS PLANTED'
  DC 9FH
  CALL CRLF
IF15
..
.. 1450 IF L<>0 THEN PRINT "LAND DEALS: ";L;" BUSHELS"..
L1450
  SEP L;DC A.0(VL)
  GHI AC;LSNZ;GLO AC;  GLO AC;  LBZ IF16
  CALL STRNG
  DC 'LAND DEALS: '
  DC 9FH
  SEP L;DC A.0(VL)
  CALL PRN
  CALL STRNG
  DC ' BUSHELS'
  DC 9FH
  CALL CRLF
IF16
..
.. 1460 IF H>0 THEN PRINT "MERCENARY HIRE: ";H..
L1460
  SEP L;DC A.0(VH)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF17
  CALL STRNG
  DC 'MERCENARY HIRE: '
  DC 9FH
  SEP L;DC A.0(VH)
  CALL PRN
  CALL CRLF
IF17
..
.. 1470 IF E>0 THEN PRINT E;" BUSHELS LOST TO RATS"..
L1470
  SEP L;DC A.0(VE)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF18
  CALL PRN
  CALL STRNG
  DC ' BUSHELS LOST TO RATS'
  DC 9FH
  CALL CRLF
IF18
..
.. 1480 IF Z<>0 THEN PRINT "FRUITS OF WAR: ";Z;" BUSHELS"..
L1480
  SEP L;DC A.0(VZ)
  GHI AC;LSNZ;GLO AC;  GLO AC;  LBZ IF19
  CALL STRNG
  DC 'FRUITS OF WAR: '
  DC 9FH
  SEP L;DC A.0(VZ)
  CALL PRN
  CALL STRNG
  DC ' BUSHELS'
  DC 9FH
  CALL CRLF
IF19
..
.. 1490 IF O>0 THEN PRINT "LOOTING LOSSES: ";O;" BUSHELS"..
L1490
  SEP L;DC A.0(VO)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF20
  CALL STRNG
  DC 'LOOTING LOSSES: '
  DC 9FH
  SEP L;DC A.0(VO)
  CALL PRN
  CALL STRNG
  DC ' BUSHELS'
  DC 9FH
  CALL CRLF
IF20
..
.. 1510 LET G=G+C-F-Q+L-H-E+Z-O..
L1510
  SEP L;DC A.0(VG)
  CALL PUSH
  SEP L;DC A.0(VC)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VF)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VQ)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VL)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VH)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VE)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VZ)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VO)
  CALL SUB
  SEP S;DC A.0(VG)
..
.. 1520 PRINT "TOTAL: ";G..
L1520
  CALL STRNG
  DC 'TOTAL: '
  DC 9FH
  SEP L;DC A.0(VG)
  CALL PRN
  CALL CRLF
..
.. 1530 GOSUB 3310..
L1530
  CALL L3310
..
.. 1600 REM NOTICE IF GAME ENDED..
L1600
..
.. 1610 IF J<100 THEN GOTO 1690..
L1610
  SEP L;DC A.0(VJ)
  GLO AC;SMI 064H;GHI AC;XRI 80H
  SMBI A.0(080H);  LBDF IF21
  LBR L1690
IF21
..
.. 1620 PRINT "THE PEASANTS TIRE OF WAR AND STARVATION"..
L1620
  CALL STRNG
  DC 'THE PEASANTS TIRE OF WAR AND STARVATION'
  DC 9FH
  CALL CRLF
..
.. 1630 PRINT "YOU ARE DEPOSED."..
L1630
  CALL STRNG
  DC 'YOU ARE DEPOSED.'
  DC 9FH
  CALL CRLF
..
.. 1640 PRINT "DO YOU WISH TO PLAY AGAIN";..
L1640
  CALL STRNG
  DC 'DO YOU WISH TO PLAY AGAIN'
  DC 9FH
..
.. 1650 LET N=Y-1..
L1650
  SEP L;DC A.0(VY)
  DEC AC
  SEP S;DC A.0(VN)
..
.. 1660 INPUT N..
L1660
  CALL GETLN
  CALL INPUT,A.0(VN)
..
.. 1670 IF Y<>N THEN END..
L1670
  SEP L;DC A.0(VY)
  CALL PUSH
  SEP L;DC A.0(VN)
  CALL IF0T
  LBZ IF22
  CALL UCALL,A.0(CDENT)
IF22
..
.. 1680 GOTO 1000..
L1680
  LBR L1000
..
.. 1690 IF P>1 THEN GOTO 1750..
L1690
  SEP L;DC A.0(VP)
  GLO AC;SDI 001H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF23
  LBR L1750
IF23
..
.. 1710 PRINT "YOU AND THE REMAINING POPULATION"..
L1710
  CALL STRNG
  DC 'YOU AND THE REMAINING POPULATION'
  DC 9FH
  CALL CRLF
..
.. 1720 PRINT "RETIRE IN THE SWISS ALPS."..
L1720
  CALL STRNG
  DC 'RETIRE IN THE SWISS ALPS.'
  DC 9FH
  CALL CRLF
..
.. 1730 GOTO 1640..
L1730
  LBR L1640
..
.. 1740 REM MAKE LAND DEALS..
L1740
..
.. 1750 LET R=23+RND(8)..
L1750
  GHI ZZ;PHI AC
  LDI 017H;  PLO AC
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 008H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  CALL ADD
  SEP S;DC A.0(VR)
..
.. 1760 GOSUB 3250..
L1760
  CALL L3250
..
.. 1770 PRINT "BUY AT ";..
L1770
  CALL STRNG
  DC 'BUY AT '
  DC 9FH
..
.. 1780 GOSUB 3220..
L1780
  CALL L3220
..
.. 1790 INPUT T..
L1790
  CALL GETLN
  CALL INPUT,A.0(VT)
..
.. 1810 IF T<0 THEN GOTO 1760..
L1810
  SEP L;DC A.0(VT)
  GHI AC;SHL;  LBNF IF24
  LBR L1760
IF24
..
.. 1820 IF T=0 THEN GOTO 1860..
L1820
  SEP L;DC A.0(VT)
  GHI AC;LSNZ;GLO AC;  GLO AC;  LBNZ IF25
  LBR L1860
IF25
..
.. 1830 IF R*T<=G THEN GOTO 2060..
L1830
  SEP L;DC A.0(VR)
  CALL PUSH
  SEP L;DC A.0(VT)
  CALL MPY
  CALL PUSH
  SEP L;DC A.0(VG)
  CALL IF0T
  LBNF IF26
  LBR L2060
IF26
..
.. 1840 GOSUB 3270..
L1840
  CALL L3270
..
.. 1850 GOTO 1760..
L1850
  LBR L1760
..
.. 1860 LET R=R-1..
L1860
  SEP L;DC A.0(VR)
  DEC AC
  SEP S;DC A.0(VR)
..
.. 1880 GOSUB 3250..
L1880
  CALL L3250
..
.. 1890 PRINT "SELL AT ";..
L1890
  CALL STRNG
  DC 'SELL AT '
  DC 9FH
..
.. 1910 GOSUB 3220..
L1910
  CALL L3220
..
.. 1920 INPUT T..
L1920
  CALL GETLN
  CALL INPUT,A.0(VT)
..
.. 1930 IF T<0 THEN GOTO 1880..
L1930
  SEP L;DC A.0(VT)
  GHI AC;SHL;  LBNF IF27
  LBR L1880
IF27
..
.. 1940 IF T=0 THEN GOTO 2060..
L1940
  SEP L;DC A.0(VT)
  GHI AC;LSNZ;GLO AC;  GLO AC;  LBNZ IF28
  LBR L2060
IF28
..
.. 1950 IF T<=A THEN GOTO 1990..
L1950
  SEP L;DC A.0(VT)
  CALL PUSH
  SEP L;DC A.0(VA)
  CALL IF0T
  LBNF IF29
  LBR L1990
IF29
..
.. 1960 PRINT "BUT THERE IS INSUFFICIENT LAND"..
L1960
  CALL STRNG
  DC 'BUT THERE IS INSUFFICIENT LAND'
  DC 9FH
  CALL CRLF
..
.. 1970 GOTO 1880..
L1970
  LBR L1880
..
.. 1990 IF T<A/10 THEN GOTO 2050..
L1990
  SEP L;DC A.0(VT)
  CALL PUSH
  SEP L;DC A.0(VA)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 00AH;  PLO AC
  CALL DIV
  CALL IF1T
  LBDF IF30
  LBR L2050
IF30
..
.. 2010 LET R=R-1..
L2010
  SEP L;DC A.0(VR)
  DEC AC
  SEP S;DC A.0(VR)
..
.. 2020 PRINT "FOR SELLING SO MUCH YOU CAN ONLY GET ";..
L2020
  CALL STRNG
  DC 'FOR SELLING SO MUCH YOU CAN ONLY GET '
  DC 9FH
..
.. 2030 GOSUB 3220..
L2030
  CALL L3220
..
.. 2040 PRINT..
L2040
  CALL CRLF
..
.. 2050 LET T=-T..
L2050
  SEP L;DC A.0(VT)
  CALL NEG
  SEP S;DC A.0(VT)
..
.. 2060 LET L=-R*T..
L2060
  SEP L;DC A.0(VR)
  CALL PUSH
  SEP L;DC A.0(VT)
  CALL MPY
  CALL NEG
  SEP S;DC A.0(VL)
..
.. 2100 REM DISTRIBUTE GRAIN..
L2100
..
.. 2110 GOSUB 3250..
L2110
  CALL L3250
..
.. 2120 PRINT "PLANT";..
L2120
  CALL STRNG
  DC 'PLANT'
  DC 9FH
..
.. 2130 INPUT Q..
L2130
  CALL GETLN
  CALL INPUT,A.0(VQ)
..
.. 2140 IF Q<0 THEN GOTO 2110..
L2140
  SEP L;DC A.0(VQ)
  GHI AC;SHL;  LBNF IF31
  LBR L2110
IF31
..
.. 2150 IF Q<=A+T THEN GOTO 2180..
L2150
  SEP L;DC A.0(VQ)
  CALL PUSH
  SEP L;DC A.0(VA)
  CALL PUSH
  SEP L;DC A.0(VT)
  CALL ADD
  CALL IF0T
  LBNF IF32
  LBR L2180
IF32
..
.. 2160 GOSUB 3270..
L2160
  CALL L3270
..
.. 2170 GOTO 2110..
L2170
  LBR L2110
..
.. 2180 IF Q<=P*10 THEN GOTO 2220..
L2180
  SEP L;DC A.0(VQ)
  CALL PUSH
  SEP L;DC A.0(VP)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 00AH;  PLO AC
  CALL MPY
  CALL IF0T
  LBNF IF33
  LBR L2220
IF33
..
.. 2190 PRINT "BUT THERE ARE INSUFFICIENT PEOPLE"..
L2190
  CALL STRNG
  DC 'BUT THERE ARE INSUFFICIENT PEOPLE'
  DC 9FH
  CALL CRLF
..
.. 2210 GOTO 2110..
L2210
  LBR L2110
..
.. 2220 PRINT "HOW MANY BUSHELS DO YOU WISH TO ";..
L2220
  CALL STRNG
  DC 'HOW MANY BUSHELS DO YOU WISH TO '
  DC 9FH
..
.. 2230 PRINT "USE AS FOOD";..
L2230
  CALL STRNG
  DC 'USE AS FOOD'
  DC 9FH
..
.. 2240 INPUT F..
L2240
  CALL GETLN
  CALL INPUT,A.0(VF)
..
.. 2250 IF F<0 THEN GOTO 2220..
L2250
  SEP L;DC A.0(VF)
  GHI AC;SHL;  LBNF IF34
  LBR L2220
IF34
..
.. 2260 IF G+L-Q-F>=0 THEN GOTO 2310..
L2260
  SEP L;DC A.0(VG)
  CALL PUSH
  SEP L;DC A.0(VL)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VQ)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VF)
  CALL SUB
  GHI AC;SHL;  LBDF IF35
  LBR L2310
IF35
..
.. 2270 GOSUB 3270..
L2270
  CALL L3270
..
.. 2280 GOTO 2220..
L2280
  LBR L2220
..
.. 2310 IF F<=40*P THEN LET S=P-F/40..
L2310
  SEP L;DC A.0(VF)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 028H;  PLO AC
  CALL PUSH
  SEP L;DC A.0(VP)
  CALL MPY
  CALL IF0T
  LBNF IF36
  SEP L;DC A.0(VP)
  CALL PUSH
  SEP L;DC A.0(VF)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 028H;  PLO AC
  CALL DIV
  CALL SUB
  SEP S;DC A.0(VS)
IF36
..
.. 2320 LET J=J+S..
L2320
  SEP L;DC A.0(VJ)
  CALL PUSH
  SEP L;DC A.0(VS)
  CALL ADD
  SEP S;DC A.0(VJ)
..
.. 2330 LET X=5+RND(4)..
L2330
  GHI ZZ;PHI AC
  LDI 005H;  PLO AC
  CALL PUSH
  DEC AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  CALL ADD
  SEP S;DC A.0(VX)
..
.. 2340 IF Y/7*8-Y/49*7=Y THEN LET X=X/2-1..
L2340
  SEP L;DC A.0(VY)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 007H;  PLO AC
  CALL DIV
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 008H;  PLO AC
  CALL MPY
  CALL PUSH
  SEP L;DC A.0(VY)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 031H;  PLO AC
  CALL DIV
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 007H;  PLO AC
  CALL MPY
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VY)
  CALL IF0T
  LBNZ IF37
  SEP L;DC A.0(VX)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 002H;  PLO AC
  CALL DIV
  DEC AC
  SEP S;DC A.0(VX)
IF37
..
.. 2350 LET C=X*Q..
L2350
  SEP L;DC A.0(VX)
  CALL PUSH
  SEP L;DC A.0(VQ)
  CALL MPY
  SEP S;DC A.0(VC)
..
.. 2360 IF G+L-Q-F+C>=0 THEN GOTO 2390..
L2360
  SEP L;DC A.0(VG)
  CALL PUSH
  SEP L;DC A.0(VL)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VQ)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VF)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VC)
  CALL ADD
  GHI AC;SHL;  LBDF IF38
  LBR L2390
IF38
..
.. 2370 LET X=(32767-G-L+Q+F)/Q..
L2370
  LDI A.0(07FH);PHI AC
  LDI 0FFH;  PLO AC
  CALL PUSH
  SEP L;DC A.0(VG)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VL)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VQ)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VF)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VQ)
  CALL DIV
  SEP S;DC A.0(VX)
..
.. 2380 GOTO 2350..
L2380
  LBR L2350
..
.. 2390 IF RND(99)<25 THEN LET E=(G+L-F+C)/10..
L2390
  GHI ZZ;PHI AC
  LDI 063H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  GLO AC;SMI 019H;GHI AC;XRI 80H
  SMBI A.0(080H);  LBDF IF39
  SEP L;DC A.0(VG)
  CALL PUSH
  SEP L;DC A.0(VL)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VF)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VC)
  CALL ADD
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 00AH;  PLO AC
  CALL DIV
  SEP S;DC A.0(VE)
IF39
..
.. 2400 REM WAR AND PLAGUE..
L2400
..
.. 2410 IF RND(99)>15 THEN GOTO 2880..
L2410
  GHI ZZ;PHI AC
  LDI 063H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  GLO AC;SDI 00FH;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF40
  LBR L2880
IF40
..
.. 2420 LET W=25..
L2420
  GHI ZZ;PHI AC
  LDI 019H;  PLO AC
  SEP S;DC A.0(VW)
..
.. 2430 PRINT "A NEARBY KINGDOM THREATENS WAR"..
L2430
  CALL STRNG
  DC 'A NEARBY KINGDOM THREATENS WAR'
  DC 9FH
  CALL CRLF
..
.. 2440 PRINT "DO YOU WISH TO MAKE A";..
L2440
  CALL STRNG
  DC 'DO YOU WISH TO MAKE A'
  DC 9FH
..
.. 2450 PRINT " PRE-EMPTIVE STRIKE";..
L2450
  CALL STRNG
  DC ' PRE-EMPTIVE STRIKE'
  DC 9FH
..
.. 2460 LET N=Y-1..
L2460
  SEP L;DC A.0(VY)
  DEC AC
  SEP S;DC A.0(VN)
..
.. 2470 INPUT N..
L2470
  CALL GETLN
  CALL INPUT,A.0(VN)
..
.. 2480 IF N=Y-1 THEN GOTO 2520..
L2480
  SEP L;DC A.0(VN)
  CALL PUSH
  SEP L;DC A.0(VY)
  DEC AC
  CALL IF0T
  LBNZ IF41
  LBR L2520
IF41
..
.. 2490 LET W=100..
L2490
  GHI ZZ;PHI AC
  LDI 064H;  PLO AC
  SEP S;DC A.0(VW)
..
.. 2510 LET J=J+5..
L2510
  SEP L;DC A.0(VJ)
  INC AC;INC AC;INC AC;INC AC;INC AC
  SEP S;DC A.0(VJ)
..
.. 2520 PRINT "HOW MANY MERCENARIES WILL YOU";..
L2520
  CALL STRNG
  DC 'HOW MANY MERCENARIES WILL YOU'
  DC 9FH
..
.. 2530 PRINT " HIRE AT 80 BUSHELS EACH";..
L2530
  CALL STRNG
  DC ' HIRE AT 80 BUSHELS EACH'
  DC 9FH
..
.. 2540 INPUT N..
L2540
  CALL GETLN
  CALL INPUT,A.0(VN)
..
.. 2550 IF N<0 THEN GOTO 2520..
L2550
  SEP L;DC A.0(VN)
  GHI AC;SHL;  LBNF IF42
  LBR L2520
IF42
..
.. 2560 LET D=G+L-Q-F+C-E..
L2560
  SEP L;DC A.0(VG)
  CALL PUSH
  SEP L;DC A.0(VL)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VQ)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VF)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VC)
  CALL ADD
  CALL PUSH
  SEP L;DC A.0(VE)
  CALL SUB
  SEP S;DC A.0(VD)
..
.. 2570 IF RND(99)<W THEN GOTO 2610..
L2570
  GHI ZZ;PHI AC
  LDI 063H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  CALL PUSH
  SEP L;DC A.0(VW)
  CALL IF1T
  LBDF IF43
  LBR L2610
IF43
..
.. 2580 PRINT "PEACE NEGOTIATIONS SUCCEED"..
L2580
  CALL STRNG
  DC 'PEACE NEGOTIATIONS SUCCEED'
  DC 9FH
  CALL CRLF
..
.. 2590 GOTO 2810..
L2590
  LBR L2810
..
.. 2610 IF W=25 THEN LET W=150..
L2610
  SEP L;DC A.0(VW)
  GLO AC;SMI 019H;LSNZ
  GHI AC;GHI AC;  LBNZ IF44
  GHI ZZ;PHI AC
  LDI 096H;  PLO AC
  SEP S;DC A.0(VW)
IF44
..
.. 2620 LET R=P-S..
L2620
  SEP L;DC A.0(VP)
  CALL PUSH
  SEP L;DC A.0(VS)
  CALL SUB
  SEP S;DC A.0(VR)
..
.. 2630 IF N>R/10 THEN GOTO 2660..
L2630
  SEP L;DC A.0(VN)
  CALL PUSH
  SEP L;DC A.0(VR)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 00AH;  PLO AC
  CALL DIV
  CALL IF0T
  LBDF IF45
  LBR L2660
IF45
..
.. 2640 LET R=3*W/5*N*N/R*100/R..
L2640
  GHI ZZ;PHI AC
  LDI 003H;  PLO AC
  CALL PUSH
  SEP L;DC A.0(VW)
  CALL MPY
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 005H;  PLO AC
  CALL DIV
  CALL PUSH
  SEP L;DC A.0(VN)
  CALL MPY
  CALL PUSH
  SEP L;DC A.0(VN)
  CALL MPY
  CALL PUSH
  SEP L;DC A.0(VR)
  CALL DIV
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 064H;  PLO AC
  CALL MPY
  CALL PUSH
  SEP L;DC A.0(VR)
  CALL DIV
  SEP S;DC A.0(VR)
..
.. 2650 GOTO 2680..
L2650
  LBR L2680
..
.. 2660 LET R=3*W/5+N*100/R..
L2660
  GHI ZZ;PHI AC
  LDI 003H;  PLO AC
  CALL PUSH
  SEP L;DC A.0(VW)
  CALL MPY
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 005H;  PLO AC
  CALL DIV
  CALL PUSH
  SEP L;DC A.0(VN)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 064H;  PLO AC
  CALL MPY
  CALL PUSH
  SEP L;DC A.0(VR)
  CALL DIV
  CALL ADD
  SEP S;DC A.0(VR)
..
.. 2680 LET K=(P-S)/2..
L2680
  SEP L;DC A.0(VP)
  CALL PUSH
  SEP L;DC A.0(VS)
  CALL SUB
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 002H;  PLO AC
  CALL DIV
  SEP S;DC A.0(VK)
..
.. 2690 LET U=-(A+T)/2..
L2690
  SEP L;DC A.0(VA)
  CALL PUSH
  SEP L;DC A.0(VT)
  CALL ADD
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 002H;  PLO AC
  CALL DIV
  CALL NEG
  SEP S;DC A.0(VU)
..
.. 2710 LET Z=-D/2..
L2710
  SEP L;DC A.0(VD)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 002H;  PLO AC
  CALL DIV
  CALL NEG
  SEP S;DC A.0(VZ)
..
.. 2720 IF R>RND(99) THEN GOTO 2760..
L2720
  SEP L;DC A.0(VR)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 063H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  CALL IF0T
  LBDF IF46
  LBR L2760
IF46
..
.. 2730 PRINT "YOU HAVE LOST THE WAR"..
L2730
  CALL STRNG
  DC 'YOU HAVE LOST THE WAR'
  DC 9FH
  CALL CRLF
..
.. 2740 LET J=J+5000/W..
L2740
  SEP L;DC A.0(VJ)
  CALL PUSH
  LDI A.0(013H);PHI AC
  LDI 088H;  PLO AC
  CALL PUSH
  SEP L;DC A.0(VW)
  CALL DIV
  CALL ADD
  SEP S;DC A.0(VJ)
..
.. 2750 GOTO 2810..
L2750
  LBR L2810
..
.. 2760 PRINT "YOU HAVE WON THE WAR"..
L2760
  CALL STRNG
  DC 'YOU HAVE WON THE WAR'
  DC 9FH
  CALL CRLF
..
.. 2770 LET K=K/2..
L2770
  SEP L;DC A.0(VK)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 002H;  PLO AC
  CALL DIV
  SEP S;DC A.0(VK)
..
.. 2780 LET U=-U..
L2780
  SEP L;DC A.0(VU)
  CALL NEG
  SEP S;DC A.0(VU)
..
.. 2790 LET Z=D/4..
L2790
  SEP L;DC A.0(VD)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 004H;  PLO AC
  CALL DIV
  SEP S;DC A.0(VZ)
..
.. 2810 IF N*80<=D+Z THEN GOTO 2870..
L2810
  SEP L;DC A.0(VN)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 050H;  PLO AC
  CALL MPY
  CALL PUSH
  SEP L;DC A.0(VD)
  CALL PUSH
  SEP L;DC A.0(VZ)
  CALL ADD
  CALL IF0T
  LBNF IF47
  LBR L2870
IF47
..
.. 2820 GOSUB 3280..
L2820
  CALL L3280
..
.. 2830 PRINT "TO PAY THE MERCENARIES"..
L2830
  CALL STRNG
  DC 'TO PAY THE MERCENARIES'
  DC 9FH
  CALL CRLF
..
.. 2840 LET M=3*(P-S-K)/4..
L2840
  GHI ZZ;PHI AC
  LDI 003H;  PLO AC
  CALL PUSH
  SEP L;DC A.0(VP)
  CALL PUSH
  SEP L;DC A.0(VS)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VK)
  CALL SUB
  CALL MPY
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 004H;  PLO AC
  CALL DIV
  SEP S;DC A.0(VM)
..
.. 2850 LET O=3*(R+Z)/4..
L2850
  GHI ZZ;PHI AC
  LDI 003H;  PLO AC
  CALL PUSH
  SEP L;DC A.0(VR)
  CALL PUSH
  SEP L;DC A.0(VZ)
  CALL ADD
  CALL MPY
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 004H;  PLO AC
  CALL DIV
  SEP S;DC A.0(VO)
..
.. 2860 GOTO 2880..
L2860
  LBR L2880
..
.. 2870 LET H=N*80..
L2870
  SEP L;DC A.0(VN)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 050H;  PLO AC
  CALL MPY
  SEP S;DC A.0(VH)
..
.. 2880 LET N=P-S-K-M..
L2880
  SEP L;DC A.0(VP)
  CALL PUSH
  SEP L;DC A.0(VS)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VK)
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VM)
  CALL SUB
  SEP S;DC A.0(VN)
..
.. 2890 IF RND(99)>4 THEN GOTO 2940..
L2890
  GHI ZZ;PHI AC
  LDI 063H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  GLO AC;SDI 004H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF48
  LBR L2940
IF48
..
.. 2910 PRINT "THE BLACK PLAGUE STRIKES"..
L2910
  CALL STRNG
  DC 'THE BLACK PLAGUE STRIKES'
  DC 9FH
  CALL CRLF
..
.. 2920 LET V=N/2..
L2920
  SEP L;DC A.0(VN)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 002H;  PLO AC
  CALL DIV
  SEP S;DC A.0(VV)
..
.. 2930 GOTO 2970..
L2930
  LBR L2970
..
.. 2940 IF RND(99)>20 THEN GOTO 2980..
L2940
  GHI ZZ;PHI AC
  LDI 063H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  GLO AC;SDI 014H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF49
  LBR L2980
IF49
..
.. 2950 PRINT "A POX EPIDEMIC BREAKS OUT"..
L2950
  CALL STRNG
  DC 'A POX EPIDEMIC BREAKS OUT'
  DC 9FH
  CALL CRLF
..
.. 2960 LET V=N/20..
L2960
  SEP L;DC A.0(VN)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 014H;  PLO AC
  CALL DIV
  SEP S;DC A.0(VV)
..
.. 2970 LET N=N-V..
L2970
  SEP L;DC A.0(VN)
  CALL PUSH
  SEP L;DC A.0(VV)
  CALL SUB
  SEP S;DC A.0(VN)
..
.. 2980 LET B=(N*RND(5)+9)/100+1..
L2980
  SEP L;DC A.0(VN)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 005H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  CALL MPY
  INC AC;INC AC;INC AC;INC AC;INC AC;INC AC;INC AC;INC AC;INC AC
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 064H;  PLO AC
  CALL DIV
  INC AC
  SEP S;DC A.0(VB)
..
.. 2990 LET D=(N*RND(3)+4)/100..
L2990
  SEP L;DC A.0(VN)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 003H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  CALL MPY
  INC AC;INC AC;INC AC;INC AC
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 064H;  PLO AC
  CALL DIV
  SEP S;DC A.0(VD)
..
.. 3010 IF Y/7*8-Y/49*7<>Y THEN GOTO 3030..
L3010
  SEP L;DC A.0(VY)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 007H;  PLO AC
  CALL DIV
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 008H;  PLO AC
  CALL MPY
  CALL PUSH
  SEP L;DC A.0(VY)
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 031H;  PLO AC
  CALL DIV
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 007H;  PLO AC
  CALL MPY
  CALL SUB
  CALL PUSH
  SEP L;DC A.0(VY)
  CALL IF0T
  LBZ IF50
  LBR L3030
IF50
..
.. 3020 PRINT "SEVEN YEAR LOCUSTS REDUCE CROP YIELD"..
L3020
  CALL STRNG
  DC 'SEVEN YEAR LOCUSTS REDUCE CROP YIELD'
  DC 9FH
  CALL CRLF
..
.. 3030 IF E>0 THEN PRINT "RATS INFEST YOUR SILOS"..
L3030
  SEP L;DC A.0(VE)
  GLO AC;SDI 000H;GHI AC;XRI 80H
  SDBI A.0(080H);  LBDF IF51
  CALL STRNG
  DC 'RATS INFEST YOUR SILOS'
  DC 9FH
  CALL CRLF
IF51
..
.. 3040 LET Y=Y+8-(Y-Y/7*7)/6..
L3040
  SEP L;DC A.0(VY)
  INC AC;INC AC;INC AC;INC AC;INC AC;INC AC;INC AC;INC AC
  CALL PUSH
  SEP L;DC A.0(VY)
  CALL PUSH
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 007H;  PLO AC
  CALL DIV
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 007H;  PLO AC
  CALL MPY
  CALL SUB
  CALL PUSH
  GHI ZZ;PHI AC
  LDI 006H;  PLO AC
  CALL DIV
  CALL SUB
  SEP S;DC A.0(VY)
..
.. 3050 GOTO 1110..
L3050
  LBR L1110
..
.. 3200 REM UTILITY PRINT ROUTINES..
L3200
..
.. 3220 PRINT R;" BUSHELS/ACRE";..
L3220
  SEP L;DC A.0(VR)
  CALL PRN
  CALL STRNG
  DC ' BUSHELS/ACRE'
  DC 9FH
..
.. 3230 RETURN..
L3230
  EXIT
..
.. 3250 PRINT "HOW MANY ACRES DO YOU WISH TO ";..
L3250
  CALL STRNG
  DC 'HOW MANY ACRES DO YOU WISH TO '
  DC 9FH
..
.. 3260 RETURN..
L3260
  EXIT
..
.. 3270 PRINT "BUT ";..
L3270
  CALL STRNG
  DC 'BUT '
  DC 9FH
..
.. 3280 PRINT "THERE IS INSUFFICIENT GRAIN"..
L3280
  CALL STRNG
  DC 'THERE IS INSUFFICIENT GRAIN'
  DC 9FH
  CALL CRLF
..
.. 3290 RETURN..
L3290
  EXIT
..
.. 3300 REM INITIALIZE POPULATION AND GRAIN VECTORS..
L3300
..
.. 3310 LET B=0..
L3310
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VB)
..
.. 3320 LET D=0..
L3320
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VD)
..
.. 3330 LET K=0..
L3330
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VK)
..
.. 3340 LET M=0..
L3340
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VM)
..
.. 3350 LET S=0..
L3350
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VS)
..
.. 3360 LET V=0..
L3360
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VV)
..
.. 3410 LET C=0..
L3410
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VC)
..
.. 3420 LET E=0..
L3420
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VE)
..
.. 3430 LET F=0..
L3430
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VF)
..
.. 3440 LET H=0..
L3440
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VH)
..
.. 3450 LET L=0..
L3450
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VL)
..
.. 3460 LET O=0..
L3460
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VO)
..
.. 3470 LET Q=0..
L3470
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VQ)
..
.. 3480 LET Z=0..
L3480
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VZ)
..
.. 3490 RETURN..
L3490
  EXIT
..
.. 3500 REM INITIALIZATION..
L3500
..
.. 3510 LET Y=RND(6)+1..
L3510
  GHI ZZ;PHI AC
  LDI 006H;  PLO AC
  GHI ZZ;DEC ES;STR ES;DEC ES;STR ES;DEC AC
  CALL RND
  INC AC
  SEP S;DC A.0(VY)
..
.. 3520 LET J=0..
L3520
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VJ)
..
.. 3530 LET P=100..
L3530
  GHI ZZ;PHI AC
  LDI 064H;  PLO AC
  SEP S;DC A.0(VP)
..
.. 3540 LET A=1500..
L3540
  LDI A.0(005H);PHI AC
  LDI 0DCH;  PLO AC
  SEP S;DC A.0(VA)
..
.. 3550 LET G=5000..
L3550
  LDI A.0(013H);PHI AC
  LDI 088H;  PLO AC
  SEP S;DC A.0(VG)
..
.. 3560 LET T=0..
L3560
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VT)
..
.. 3570 LET U=0..
L3570
  GHI ZZ;PHI AC
  PLO AC
  SEP S;DC A.0(VU)
..
.. 3580 GOSUB 3310..
L3580
  CALL L3310
..
.. 3590 LET C=-1..
L3590
  LDI A.0(0FFH);PHI AC
  PLO AC
  SEP S;DC A.0(VC)
..
.. 3600 REM PRINT INSTRUCTIONS (MAY BE OMITTED)..
L3600
..
.. 3610 PRINT "DO YOU NEED INSTRUCTIONS (Y OR N)";..
L3610
  CALL STRNG
  DC 'DO YOU NEED INSTRUCTIONS (Y OR N)'
  DC 9FH
..
.. 3620 LET N=P..
L3620
  SEP L;DC A.0(VP)
  SEP S;DC A.0(VN)
..
.. 3630 INPUT N..
L3630
  CALL GETLN
  CALL INPUT,A.0(VN)
..
.. 3640 IF N=P THEN RETURN..
L3640
  SEP L;DC A.0(VN)
  CALL PUSH
  SEP L;DC A.0(VP)
  CALL IF0T
  LBNZ IF52
  EXIT
IF52
..
.. 3650 IF N=Y THEN GOTO 3710..
L3650
  SEP L;DC A.0(VN)
  CALL PUSH
  SEP L;DC A.0(VY)
  CALL IF0T
  LBNZ IF53
  LBR L3710
IF53
..
.. 3660 PRINT "PLEASE TYPE Y FOR YES, N FOR NO. OK";..
L3660
  CALL STRNG
  DC 'PLEASE TYPE Y FOR YES, N FOR NO. OK'
  DC 9FH
..
.. 3670 GOTO 3620..
L3670
  LBR L3620
..
.. 3710 PRINT "YOU HAVE INHERITED THE THRONE TO THE MEDIEVAL"..
L3710
  CALL STRNG
  DC 'YOU HAVE INHERITED THE THRONE TO THE MEDIEVAL'
  DC 9FH
  CALL CRLF
..
.. 3720 PRINT "KINGDOM OF EUPHORIA, SOMEWHERE IN EUROPE."..
L3720
  CALL STRNG
  DC 'KINGDOM OF EUPHORIA, SOMEWHERE IN EUROPE.'
  DC 9FH
  CALL CRLF
..
.. 3730 PRINT "AT THIS TIME IT IS ABOUT ";A;" ACRES IN SIZE,"..
L3730
  CALL STRNG
  DC 'AT THIS TIME IT IS ABOUT '
  DC 9FH
  SEP L;DC A.0(VA)
  CALL PRN
  CALL STRNG
  DC ' ACRES IN SIZE,'
  DC 9FH
  CALL CRLF
..
.. 3740 PRINT "WITH ";P;" LOYAL PEASANTS TO SERVE YOU."..
L3740
  CALL STRNG
  DC 'WITH '
  DC 9FH
  SEP L;DC A.0(VP)
  CALL PRN
  CALL STRNG
  DC ' LOYAL PEASANTS TO SERVE YOU.'
  DC 9FH
  CALL CRLF
..
.. 3750 PRINT "IN YOUR ROYAL SILOS YOU HAVE ";G;" BUSHELS OF"..
L3750
  CALL STRNG
  DC 'IN YOUR ROYAL SILOS YOU HAVE '
  DC 9FH
  SEP L;DC A.0(VG)
  CALL PRN
  CALL STRNG
  DC ' BUSHELS OF'
  DC 9FH
  CALL CRLF
..
.. 3760 PRINT "NUTRITIOUS GRAIN WITH WHICH TO FEED THE PEOPLE"..
L3760
  CALL STRNG
  DC 'NUTRITIOUS GRAIN WITH WHICH TO FEED THE PEOPLE'
  DC 9FH
  CALL CRLF
..
.. 3770 PRINT "AND TRANSACT INTERNATIONAL TRADE."..
L3770
  CALL STRNG
  DC 'AND TRANSACT INTERNATIONAL TRADE.'
  DC 9FH
  CALL CRLF
..
.. 3780 PRINT "CLOSE BY YOUR SIDE ARE JEALOUS NEIGHBORING"..
L3780
  CALL STRNG
  DC 'CLOSE BY YOUR SIDE ARE JEALOUS NEIGHBORING'
  DC 9FH
  CALL CRLF
..
.. 3790 PRINT "KINGDOMS, BUT YOU CAN PROTECT YOURSELF BY"..
L3790
  CALL STRNG
  DC 'KINGDOMS, BUT YOU CAN PROTECT YOURSELF BY'
  DC 9FH
  CALL CRLF
..
.. 3810 PRINT "HIRING EVIL MERCENARIES."..
L3810
  CALL STRNG
  DC 'HIRING EVIL MERCENARIES.'
  DC 9FH
  CALL CRLF
..
.. 3820 PRINT "EACH YEAR YOUR MINISTERS WILL PRESENT YOU"..
L3820
  CALL STRNG
  DC 'EACH YEAR YOUR MINISTERS WILL PRESENT YOU'
  DC 9FH
  CALL CRLF
..
.. 3830 PRINT "WITH A SUMMARY OF YOUR CURRENT STATUS,"..
L3830
  CALL STRNG
  DC 'WITH A SUMMARY OF YOUR CURRENT STATUS,'
  DC 9FH
  CALL CRLF
..
.. 3840 PRINT "AND THEN ASK YOU FOR DECISIONS ON WHAT"..
L3840
  CALL STRNG
  DC 'AND THEN ASK YOU FOR DECISIONS ON WHAT'
  DC 9FH
  CALL CRLF
..
.. 3850 PRINT "TO DO FOR THE NEXT YEAR. PLEASE TYPE Y OR N"..
L3850
  CALL STRNG
  DC 'TO DO FOR THE NEXT YEAR. PLEASE TYPE Y OR N'
  DC 9FH
  CALL CRLF
..
.. 3860 PRINT "FOR YES OR NO, OR A WHOLE NUMBER FOR"..
L3860
  CALL STRNG
  DC 'FOR YES OR NO, OR A WHOLE NUMBER FOR'
  DC 9FH
  CALL CRLF
..
.. 3870 PRINT "NUMERIC ANSWERS. IF YOU CHANGE YOUR MIND"..
L3870
  CALL STRNG
  DC 'NUMERIC ANSWERS. IF YOU CHANGE YOUR MIND'
  DC 9FH
  CALL CRLF
..
.. 3880 PRINT "BEFORE HITTING RETURN, HOLD THE 'CTRL' KEY"..
L3880
  CALL STRNG
  DC 'BEFORE HITTING RETURN, HOLD THE ''CTRL'' KEY'
  DC 9FH
  CALL CRLF
..
.. 3890 PRINT "DOWN WHILE TYPING THE LETTER 'X', THEN"..
L3890
  CALL STRNG
  DC 'DOWN WHILE TYPING THE LETTER ''X'', THEN'
  DC 9FH
  CALL CRLF
..
.. 3910 PRINT "RETYPE YOUR ANSWER ON THE NEXT LINE."..
L3910
  CALL STRNG
  DC 'RETYPE YOUR ANSWER ON THE NEXT LINE.'
  DC 9FH
  CALL CRLF
..
.. 3920 PRINT "ARE YOU READY, YOUR HIGHNESS";..
L3920
  CALL STRNG
  DC 'ARE YOU READY, YOUR HIGHNESS'
  DC 9FH
..
.. 3930 LET N=P..
L3930
  SEP L;DC A.0(VP)
  SEP S;DC A.0(VN)
..
.. 3940 INPUT N..
L3940
  CALL GETLN
  CALL INPUT,A.0(VN)
..
.. 3950 IF N<>Y THEN GOTO 3920..
L3950
  SEP L;DC A.0(VN)
  CALL PUSH
  SEP L;DC A.0(VY)
  CALL IF0T
  LBZ IF54
  LBR L3920
IF54
..
.. 3980 RETURN..
L3980
  EXIT
..
.. 3990 END..
L3990
  CALL UCALL,A.0(CDENT)
..

..
..  BASIC1 SUBROUTINE LIBRARY VERSION 2.0 FOR ASM8 ON MCDOS
..
..  ABS FUNCTION
..
ABS      GHI AC;SHL;LSDF;EXIT;NOP
..
..  SUBTRACT AC FROM 0000
..
NEG      GLO AC;SDI 0;PLO AC
         GHI AC;SDBI 0;PHI AC;EXIT
..
..  ADD/SUB STACK TO AC
..
SUB      CALL NEG
ADD      SEX ES;GLO AC;ADD;PLO AC;INC ES
         GHI AC;ADC;PHI AC;INC ES;EXIT
..
..  RANDOM NUMBER GENERATOR
..
RND      SEX ES;GLO AC;SM;PLO AC;INC ES
         GHI AC;SMB;PHI AC;DEC ES;INC AC
         CALL PUSH;SEP L;DC A.0(RNDN)
         SEX ES;DEC ES;LDI 01AH;STXD
         LDI 085H;STXD;LDI 9;STXD
         LDI 029H;STR ES;CALL MPY
         CALL ADD;SEP S;DC A.0(RNDN)
         GHI AC;PLO AC;LDN XX;PHI AC
         CALL RDS;CALL RDS
         CALL RDS;CALL ABS
         CALL DIV;CALL MPY
         CALL SUB;CALL ABS
         INC ES;INC ES;LBR ADD
RDS      GLO ES;PLO XX;CALL PUSH
         LDA XX;PLO AC;LDA XX;PHI AC;EXIT
RNDN     EQU  VARS
..
..  MULTIPLY AC * ES STACK
..
MPY      LDI 16;PLO RF;LDI 0;PHI XX;PLO XX
         SEX ES
MPYL     GLO AC;SHR;LBNF MPYS
         GLO XX;ADD;PLO XX;INC ES
         GHI XX;ADC;DEC ES;SKP
MPYS     GHI XX;SHRC;PHI XX;GLO XX;SHRC;PLO XX
         GHI AC;SHRC;PHI AC;GLO AC;SHRC;PLO AC
         DEC RF;GLO RF;LBNZ MPYL
         INC ES;INC ES;EXIT
..
..  DIVIDE ES STACK/AC
..
DIV      GHI AC;STR 2;GLO AC;OR;ADI 0FFH
         INC ES;LDA ES;LBDF DOK;CALL UCALL,A.0(CDENT);EXIT
DOK      XOR;STXD;DEC ES;DEC ES;CALL ABS
         GHI AC;PHI XX;GLO AC;PLO XX;LDA ES
         PLO AC;LDN ES;PHI AC;CALL ABS
         SEX ES;LDI 0;STXD;STR ES
         LDI 17;PLO RF
DIVL     GLO XX;SD;STR 2;INC ES
         GHI XX;SDB;LBNF DIVS
         STXD;LDN 2;STR ES;SKP
DIVS     DEC ES;GLO AC;SHLC;PLO AC
         GHI AC;SHLC;PHI AC
         DEC RF;GLO RF;LBZ DIVX
         LDN ES;SHLC;STR ES;INC ES
         LDN ES;SHLC;STXD;LBR DIVL
DIVX     INC ES;INC ES;INC 2;LDN 2
MODX     SHL;LBDF NEG;EXIT
..
..  PRINT STRING
..
STRNL    XRI 09FH;CALL OUCH
STRNG    LDA 6;XRI 09FH;LBNZ STRNL;EXIT
..
..  PRINT END LINE (CRLF)
..
LEND     LDI 6;PHI RF
         DEC RF;GHI RF;LBNZ $-2
CRLF     CALL STRNG,0DH
         DC 0A9FH;LDN XX;ANI 0E0H;STR XX;EXIT
..
..  PRINT TAB
..
TAB      LDI 020H;CALL OUCH
         LDA XX;ANI 7;LBNZ TAB;EXIT
..
..  OUTPUT A CHARACTER
..
OUCH     PHI RF;LDI A.1(TTYCC);PHI XX;LDI TTYCC;PLO XX
         LDN XX;ADI 1;ANI 0EFH;STR XX;SHL
         GHI RF;LBNF PUTCH;EXIT
..
..  PRINT A NUMBER
..
PRN      GHI AC;SHL;LBNF PRP;LDI 02DH
         CALL OUCH;CALL NEG
PRP      LDI 0;STXD
PRPL     CALL PUSH
         LDI 0;PHI AC;LDI 10;PLO AC
         CALL DIV;DEC ES;DEC ES
         LDA ES;INC ES;ORI 030H;STXD
         GHI AC;STR 2;GLO AC;OR;LBNZ PRPL
PRNP     INC 2;LDN 2;LSNZ;EXIT;NOP
         CALL OUCH;LBR PRNP
..
..  INPUT NEW LINE
..
RUBOUT   DEC XX;GLO XX;.XOR.A.0(LINE)
         LBZ CANC;@XX->RF.1;XX.1->@-;XX.0->@-;RF.1
         CALL CHOUT;INC R2;@!->XX.0;@R2->XX.1;LBR INCH
GETLF    LDI 080H;LSKP
GETXF    LDI 0;STR 2;LDI TTYCC;PLO XX
         LDN XX;ANI 07FH;OR;STR XX
         SMI 0;LBR GETN
BACKS    XX.1->@-;XX.0->@-
         CALL STRNG;DC 2008H,9FH          ..ASCII SPACE,BS
         INC R2;@!->XX.0;@R2->XX.1
         DEC XX;GLO XX;SMI LINE;LBDF INCH
CANC     CALL LEND
GETLN    CALL STRNG,3F20H,919FH
         ADI 0
GETN     LDI A.1(INPTR);PHI XX;LDI INPTR;PLO XX
         LDI LINE;LSNF;LDA XX;SKP;STR XX;PLO XX
INCH     CALL GETCH;->@R2
         .XOR.7FH;LBZ RUBOUT              ..ASCII RUBOUT
         .XOR.(7FH.XOR.0AH);LBZ GETLF     ..ASCII LINE FEED
         .XOR.(0AH.XOR.13H);LBZ GETXF     ..ASCII DC3
         .XOR.(13H.XOR.3);LBZ CANC        ..ASCII CANCEL (CNTRL X)
         .XOR.(3.XOR.8);LBZ BACKS         ..ASCII BACKSPACE
         @R2;->@XX;.XOR.0DH               ..ASCII CARRIAGE RETURN
         LBZ LEND;INC XX;GLO XX;SMI A.0(VARS-8)
         LSNF;DEC XX;NOP;LBR INCH
..
..  INPUT NUMBER TO AC
..
         CALL GETLN
INPUT    SEP L;DC A.0(INPTR-1);PLO XX;LDI 0;PLO AC;PHI AC
         PLO RF;PHI RF;SKP;DEC RF
INPUL    LDA XX;LSZ;XRI 00DH;LBZ INPUT-3
         XRI 020H;LBZ INPUL-1
         XRI 001H;LBZ INPUL
         XRI 00FH;LBZ IHEX
         XRI 003H;LBZ INPUL
INPUN    XRI 020H;SMI 03AH;LBDF INPUX
         ADI 10;LBNF INPUX;STXD
         GLO XX;STXD;DEC ES;LDI 0;STR ES
         DEC ES;LDI 10;STR ES;CALL MPY
         LDI A.1(LINE);PHI XX;INC 2;LDA 2;PLO XX
         GLO AC;ADD;PLO AC;GHI AC;ADCI 0;PHI AC
INPUS    LDA XX;XRI 020H;LBZ INPUS
         LBR INPUN
IHEX     LDA XX;SMI 020H;LBZ IHEX;LSNF
         SMI 010H;LBNF INPUX;STR 2
         SMI 15;ORI 8;LSNF;STR 2;NOP
         LDI 4;PLO RF
IHEX4    GLO AC;SHL;PLO AC;GHI AC;SHLC;PHI AC
         DEC RF;GLO RF;LBNZ IHEX4
         GLO AC;OR;PLO AC;LBR IHEX
INPUX    DEC XX;GLO XX;STR 2;LDI INPTR;PLO XX
         LDN 2;STR XX;GHI RF;LBZ ISTOR
         CALL NEG
ISTOR    LDA 6;INC S;SEP S;EXIT
..
..  STORE VARIABLE FROM AC
..
         SEP 3
STORE    LDA 3;PLO XX;LDI A.1(VARS);PHI XX
         GHI AC;STR XX;INC XX;GLO AC;STR XX
         LBR STORE-1
..
..  LOAD VARIABLE TO AC
..
         SEP 3
LOAD     LDA 3;PLO XX;LDI A.1(VARS);PHI XX
         LDA XX;PHI AC;LDN XX;PLO AC;LBR LOAD-1
..
..  PUSH AC INTO STACK
..
PUSH     DEC ES;GHI AC;STR ES
         DEC ES;GLO AC;STR ES;EXIT
..
..  COMPARE AC TO ES STACK
..
IF0T     LDA ES; STR 2;GLO AC;SM;STXD
         LDA ES;XRI 080H;STR 2;GHI AC;XRI 080H
         SMB;INC 2;OR;EXIT
IF1T     LDA ES; STR 2;GLO AC;SD;STXD
         LDA ES;XRI 080H;STR 2;GHI AC;XRI 080H
         SDB;INC 2;OR;EXIT
..
..  I/O SELECTION
..
CHIN     EQU $
         LBR 0813EH
CHOUT    EQU $
         SEX 2;STXD
         CALL 81A5H;INC 2;LDN 2
         EXIT..
CEND
..
  ORG VARS+2
VA  DC 0000H
VB  DC 0000H
VC  DC 0000H
VD  DC 0000H
VE  DC 0000H
VF  DC 0000H
VG  DC 0000H
VH  DC 0000H
VI  DC 0000H
VJ  DC 0000H
VK  DC 0000H
VL  DC 0000H
VM  DC 0000H
VN  DC 0000H
VO  DC 0000H
VP  DC 0000H
VQ  DC 0000H
VR  DC 0000H
VS  DC 0000H
VT  DC 0000H
VU  DC 0000H
VV  DC 0000H
VW  DC 0000H
VX  DC 0000H
VY  DC 0000H
VZ  DC 0000H
..
LAST EQU CEND
..
  END
EH
CHOUT    EQU $
         SEX 2;STXD
         CALL 81A5H;INC 2;LDN 2
         EXIT..
CEND
..
  ORG VARS+2
VA  DC 0000H
VB  DC 0000H
VC  DC 0000H
VD  DC 0000H
VE  DC 0000H
VF  DC 0000H
VG  DC 0000H
VH  DC 0000H
VI  DC 0000H
VJ  DC 0000H
VK  DC 0000H
VL  DC 0000H
VM  DC 0000H
VN  DC 00
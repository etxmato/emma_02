          
100 REM TIC-TAC-TOE, YOU (X) VS. THE COMPUTER (O)
200 REM
205 REM BASIC1 COMPILER VERSION 1
206 REM USE START ADD=256,VAR=46,STACK = #0CFF
207 REM DO NOT RUN IN INTERPRETER  
209 REM  
210 PRINT "TIC-TAC-TOE"
220 PRINT "DO YOU NEED"
230 PRINT "INSTRUCTIONS"
240 A=0
250 B=0
260 C=0
270 D=0
280 E=0
290 F=0
293 REM BOARD ARRAY LOCATION
295 H=#0C00
300 Y=0
320 PRINT "(Y,N)";
330 INPUT I
340 IF I<>Y GOTO 1000
350 PRINT
355 PRINT "PLEASE ANSWER"
360 PRINT "0 FOR YES,"
365 PRINT "1 FOR NO."
370 PRINT "UNDERSTAND";
380 INPUT I
390 IF I<>Y GOTO 350
400 PRINT
410 PRINT "YOU PLAY X BY"
415 PRINT "TYPING A NUMBER"
420 PRINT "OF A SQUARE.  I"
425 PRINT "PLAY O. TO START"
430 PRINT "OVER, TYPE THE"
435 PRINT "NUMBER 0.  OK";
440 INPUT I
450 IF I<>Y GOTO 220
455 PRINT
460 PRINT "PLEASE BE PATIENT"
465 PRINT "WITH ME; I THINK"
470 PRINT "VERY SLOWLY."
495 PRINT
500 REM---ON WITH THE SHOW...
1000 LET F=1
1010 PRINT "  NEW GAME";
1020 INPUT I
1030 IF I<>Y THEN 6540
1100 LET I=H+1
1110 LET @I=0
1115 LET I=I+1
1120 IF I<H+10 GOTO 1110
1130 LET U=9
1140 LET Z=0
1150 IF F=0 THEN GOTO 4010
1160 GOTO 2010
1500 REM X WON.
1510 LET Z=1
1520 LET F=0
2000 REM PRINT GAME STATE
2010 REM PLOT 12
2015 PRINT
2020 LET I=1
2030 X=@(I+H)
2040 IF X=0 PRINT I;
2050 IF X=1 PRINT "X";
2060 IF X=3 PRINT "O";
2070 IF I/3*3<>I PRINT " : ";
2080 IF I<>3 GOTO 2110
2090 PRINT 
2100 PRINT "---------"
2110 IF I<>6 GOTO 2140 
2120 PRINT
2130 PRINT "---------"
2140 I=I+1
2150 IF I<10 GOTO 2030
2160 PRINT
3000 IF Z=0 GOTO 3100
3010 REM THE GAME IS OVER.
3020 IF F=1 GOTO 3050
3030 PRINT "YOU WIN. MORE";
3040 GOTO 1020
3050 PRINT "I WIN.  AGAIN";
3060 GOTO 1020
3100 IF U>0 GOTO 3210
3110 PRINT "CAT'S GAME";
3120 LET F=1-F
3130 GOTO 1020
3140 REM PLOT 41,0
3150 F=1-F
3160 GOTO 1010
3200 REM INPUT NEXT PLAY.
3210 REM PLOT 5,35
3212 PRINT "YOUR ";
3214 REM PLOT 11,35
3216 PRINT "PLAY";
3220 INPUT I
3230 IF I>0 IF I<10 GOTO 3270
3232 IF I=0 GOTO 3140
3236 REM PLOT 12
3238 PRINT
3240 PRINT "PLEASE"
3242 PRINT "PLAY A"
3244 PRINT "NUMBER"
3246 PRINT "1 - 9"
3248 PRINT "FOR YOUR"
3250 PRINT "PLAY."
3255 IF I=0 GOTO 2000
3260 GOTO 3210
3270 IF @(I+H)=0 GOTO 3310
3272 REM PLOT 12
3274 PRINT
3276 PRINT "SQUARE"
3278 PRINT "# ";I;" IS"
3280 PRINT "ALREADY"
3282 PRINT "TAKEN."
3290 GOTO 3210
3300 REM CHECK IF X WON.
3310 LET @(I+H)=1
3315 LET U=U-1
3320 LET W=6100
3330 IF W=6100 GOSUB 6100
3332 IF W=6200 GOSUB 6200
3334 IF W=6300 GOSUB 6300
3336 IF W=6400 GOSUB 6400
3340 IF J>0 IF L*M*N=1 GOTO 1510
3350 LET W=W+100
3360 IF W<6500 GOTO 3330
3400 REM CHECK IF CATS GAME
3410 IF U=0 GOTO 2010
4000 REM FIND BEST "O" PLAY
4010 LET I=1
4020 LET T=-1
4290 REM EVALUATE I'TH SQUARE
4300 LET S=0
4310 IF @(I+H)>0 GOTO 4480
4320 LET W=6100
4330 IF W=6100 GOSUB 6100
4332 IF W=6200 GOSUB 6200
4334 IF W=6300 GOSUB 6300
4336 IF W=6400 GOSUB 6400
4340 IF J=0 GOTO 4410
4350 LET J=L+M+N
4360 IF J=4 THEN GOTO 4410
4370 IF J=2 THEN LET S=S+20
4380 IF J=6 THEN LET S=S+100
4390 IF J=0 THEN LET S=S+2
4400 LET S=S+J
4410 LET W=W+100
4420 IF W<6500 GOTO 4330
4430 IF S<T THEN GOTO 4470
4440 LET T=S
4450 LET B=I
4460 REM SAY SOMETHING, SO IT WONT SEEM SO LONG.
4470 REM PLOT 10,40,10
4480 LET I=I+1
4490 IF I<10 GOTO 4300
4500 REM PLOT 12
4501 PRINT
4502 REM PLOT 24,35
4504 PRINT "I PLAYED ";B
4506 REM PLOT B+48
4510 PRINT
4520 LET @(B+H)=3
4530 LET U=U-1
4540 IF T<100 THEN GOTO 2020
4550 REM I WON I WON I WON
4560 F=1
4570 Z=1
4580 GOTO 2010
6000 REM SUBROUTINE TO LOOK AT ONE ROW, COL, OR DIAG
6010 REM I IS THE POSITION OF REFERENCE
6020 REM L,M,N ARE RETURNED WITH CONTENTS OF THE THREE SQUARES
6030 REM ENTER AT 6100,6200,6300, OR 6400...
6040 REM  TO EXAMINE ROW,COLUMN,DOWN DIAGONAL OR UP DIAGONAL
6090 REM W=HORIZONTAL
6100 LET J=(I-1)/3*3+8
6110 LET D=1
6120 GOTO 6500
6190 REM W=VERTICAL
6200 LET J=I-(I-1)/3*3+9
6210 LET D=3
6220 GOTO 6500
6290 REM W=DOWN DIAGONAL
6300 IF I-1<>(I-1)/4*4 GOTO 6440
6310 LET D=4
6320 REM BOTH DIAGONALS GO THRU CENTER
6330 LET J=11
6340 GOTO 6500
6390 REM W=UP DIAGONAL
6400 LET D=2
6410 IF I>1 IF I<9 IF I=I/2*2+1 GOTO 6330
6430 REM A DIAGONAL DOES NOT GO THRU THIS SQUARE
6440 LET J=0
6450 RETURN
6490 REM NOW WE KNOW CENTER OF THIS THREE AND +/- OFFSET
6500 LET L=@(J-D+H-6)
6510 LET M=@(J+H-6)
6520 LET N=@(J+D+H-6)
6530 RETURN
6540 END

END

